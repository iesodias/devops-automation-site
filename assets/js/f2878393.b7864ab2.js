"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[6159],{7603:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>t,contentTitle:()=>c,default:()=>m,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"modulo-04-security/secrets","title":"Secrets & Vari\xe1veis no GitHub Actions","description":"Introdu\xe7\xe3o","source":"@site/curso-github-actions-udemy/modulo-04-security/02-Secrets-Variaveis.md","sourceDirName":"modulo-04-security","slug":"/modulo-04-security/secrets","permalink":"/udemy/github-actions-automacao/modulo-04-security/secrets","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"secrets","title":"Secrets & Vari\xe1veis no GitHub Actions"},"sidebar":"tutorialSidebar","previous":{"title":"Github Token","permalink":"/udemy/github-actions-automacao/modulo-04-security/github-token"}}');var r=i(4848),n=i(8453);const a={id:"secrets",title:"Secrets & Vari\xe1veis no GitHub Actions"},c="Secrets & Vari\xe1veis no GitHub Actions",t={},d=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Defini\xe7\xe3o",id:"defini\xe7\xe3o",level:2},{value:"Explica\xe7\xe3o T\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Escopos e Hierarquia",id:"escopos-e-hierarquia",level:3},{value:"Acesso em Workflow",id:"acesso-em-workflow",level:3},{value:"Ciclo de Vida e Seguran\xe7a",id:"ciclo-de-vida-e-seguran\xe7a",level:3},{value:"Pol\xedtica de Forks",id:"pol\xedtica-de-forks",level:3},{value:"Boas Pr\xe1ticas (Resumo)",id:"boas-pr\xe1ticas-resumo",level:3},{value:"Limita\xe7\xf5es Comuns",id:"limita\xe7\xf5es-comuns",level:3},{value:"Intera\xe7\xe3o com Environments",id:"intera\xe7\xe3o-com-environments",level:3},{value:"Erros e Armadilhas Frequentes",id:"erros-e-armadilhas-frequentes",level:3},{value:"Exemplo Pr\xe1tico",id:"exemplo-pr\xe1tico",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function l(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"secrets--vari\xe1veis-no-github-actions",children:"Secrets & Vari\xe1veis no GitHub Actions"})}),"\n",(0,r.jsx)(s.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,r.jsx)(s.p,{children:'Ao automatizar processos com GitHub Actions surgem duas necessidades distintas: (a) armazenar credenciais ou valores sens\xedveis com seguran\xe7a; (b) parametrizar execu\xe7\xf5es com valores n\xe3o sens\xedveis que podem mudar por ambiente ou contexto. Para isso a plataforma oferece "Secrets" e "Variables". Entender diferen\xe7as, escopos, resolu\xe7\xe3o e boas pr\xe1ticas evita vazamentos, acoplamento excessivo e comportamento inesperado em workflows.'}),"\n",(0,r.jsx)(s.h2,{id:"defini\xe7\xe3o",children:"Defini\xe7\xe3o"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Secrets: valores sens\xedveis (tokens, chaves API, senhas) criptografados e nunca exibidos em claro na interface ou logs. Disponibilizados apenas em tempo de execu\xe7\xe3o do workflow que possui permiss\xe3o de leitura deles. S\xe3o mascarados quando impressos."}),"\n",(0,r.jsx)(s.li,{children:"Variables (Actions variables): valores n\xe3o sens\xedveis (ex: NOME_APLICACAO, REGIAO_PADRAO) usados para parametriza\xe7\xe3o est\xe1vel. Podem ser definidos em reposit\xf3rio, ambiente (environment) ou organiza\xe7\xe3o."}),"\n",(0,r.jsxs)(s.li,{children:["Environment variables (env): vari\xe1veis definidas diretamente no YAML (",(0,r.jsx)(s.code,{children:"env:"}),") ou em steps. N\xe3o s\xe3o criptografadas. Podem referenciar secrets e variables."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o T\xe9cnica"}),"\n",(0,r.jsx)(s.h3,{id:"escopos-e-hierarquia",children:"Escopos e Hierarquia"}),"\n",(0,r.jsx)(s.p,{children:"Secrets e variables podem existir em m\xfaltiplos n\xedveis:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Reposit\xf3rio: vis\xedveis apenas naquele reposit\xf3rio."}),"\n",(0,r.jsx)(s.li,{children:"Ambiente (Environment): associados a um environment (ex: staging, production); s\xf3 expostos a jobs que referenciem explicitamente o environment."}),"\n",(0,r.jsx)(s.li,{children:"Organiza\xe7\xe3o: reutiliz\xe1veis em v\xe1rios reposit\xf3rios (respeitando pol\xedticas de acesso/sele\xe7\xe3o de reposit\xf3rios permitidos)."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Preced\xeancia t\xedpica de resolu\xe7\xe3o dentro de um job (para vari\xe1veis com mesmo nome):"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Vari\xe1vel definida diretamente em ",(0,r.jsx)(s.code,{children:"env"})," no step."]}),"\n",(0,r.jsxs)(s.li,{children:["Vari\xe1vel definida em ",(0,r.jsx)(s.code,{children:"env"})," no job."]}),"\n",(0,r.jsxs)(s.li,{children:["Vari\xe1vel definida em ",(0,r.jsx)(s.code,{children:"env"})," no n\xedvel do workflow."]}),"\n",(0,r.jsx)(s.li,{children:"Actions variable em Environment."}),"\n",(0,r.jsx)(s.li,{children:"Actions variable em Reposit\xf3rio."}),"\n",(0,r.jsxs)(s.li,{children:["Actions variable em Organiza\xe7\xe3o.\n(Secrets n\xe3o fazem shadow de vari\xe1veis; s\xe3o acessados explicitamente via ",(0,r.jsx)(s.code,{children:"secrets.NOME"}),")."]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"acesso-em-workflow",children:"Acesso em Workflow"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Secret: ",(0,r.jsx)(s.code,{children:"${{ secrets.MEU_TOKEN }}"})]}),"\n",(0,r.jsxs)(s.li,{children:["Variable: ",(0,r.jsx)(s.code,{children:"${{ vars.NOME_APLICACAO }}"})," (alias moderno ",(0,r.jsx)(s.code,{children:"vars"})," para GitHub Actions variables)"]}),"\n",(0,r.jsxs)(s.li,{children:["Env local: ",(0,r.jsx)(s.code,{children:"${{ env.NOME }}"})," ou ",(0,r.jsx)(s.code,{children:"$NOME"})," (dependendo do shell)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"ciclo-de-vida-e-seguran\xe7a",children:"Ciclo de Vida e Seguran\xe7a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Secrets: criptografia em repouso; n\xe3o podem ser listados em claro; substitui\xe7\xe3o (rotacionar) exige sobrescrever valor; removidos deixam de estar acess\xedveis imediatamente; mascaramento autom\xe1tico nos logs (strings longas podem exigir cuidados se fragmentadas ou se o output gerar transforma\xe7\xf5es)."}),"\n",(0,r.jsx)(s.li,{children:"Variables: valores exibidos em claro na interface; \xfateis para evitar repeti\xe7\xe3o de literais; n\xe3o devem conter credenciais."}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"pol\xedtica-de-forks",children:"Pol\xedtica de Forks"}),"\n",(0,r.jsx)(s.p,{children:"Workflows disparados de forks em reposit\xf3rios p\xfablicos n\xe3o recebem automaticamente secrets do reposit\xf3rio pai, exceto em casos de permiss\xf5es controladas (ex: pull requests de forks n\xe3o t\xeam acesso \xe0 maioria dos secrets por padr\xe3o). Isso reduz risco de exfiltra\xe7\xe3o via execu\xe7\xe3o maliciosa."}),"\n",(0,r.jsx)(s.h3,{id:"boas-pr\xe1ticas-resumo",children:"Boas Pr\xe1ticas (Resumo)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Minimizar escopo: secrets de produ\xe7\xe3o em Environment espec\xedfico + aprova\xe7\xe3o manual se necess\xe1rio."}),"\n",(0,r.jsx)(s.li,{children:"Rota\xe7\xe3o peri\xf3dica: sincronizar com pol\xedtica de expira\xe7\xe3o do provedor externo."}),"\n",(0,r.jsx)(s.li,{children:"N\xe3o reutilizar a mesma chave para m\xfaltiplos sistemas."}),"\n",(0,r.jsx)(s.li,{children:"Evitar eco direto em shell: se precisar depurar, criar hash parcial."}),"\n",(0,r.jsxs)(s.li,{children:["Segregar por finalidade: ex: ",(0,r.jsx)(s.code,{children:"DOCKER_REGISTRY_TOKEN"}),", ",(0,r.jsx)(s.code,{children:"API_BACKEND_KEY"}),", ",(0,r.jsx)(s.code,{children:"SLACK_WEBHOOK_URL"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Usar ",(0,r.jsx)(s.code,{children:"permissions:"})," m\xednimos no workflow para reduzir impacto caso secret seja comprometido."]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"limita\xe7\xf5es-comuns",children:"Limita\xe7\xf5es Comuns"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Tamanho m\xe1ximo por secret (documenta\xe7\xe3o oficial deve ser consultada se mudar limite)."}),"\n",(0,r.jsx)(s.li,{children:"Secrets n\xe3o suportam interpola\xe7\xe3o din\xe2mica dentro do arquivo antes da execu\xe7\xe3o; resolu\xe7\xe3o acontece em runtime do expression engine."}),"\n",(0,r.jsx)(s.li,{children:"N\xe3o h\xe1 como recuperar o valor original via API; apenas sobrescrever."}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"intera\xe7\xe3o-com-environments",children:"Intera\xe7\xe3o com Environments"}),"\n",(0,r.jsxs)(s.p,{children:["Environments podem exigir aprova\xe7\xf5es ou proteger secrets sens\xedveis (ex: ",(0,r.jsx)(s.code,{children:"PROD_DB_PASSWORD"}),"). O job que especifica ",(0,r.jsx)(s.code,{children:"environment: production"})," s\xf3 acessa aqueles secrets ap\xf3s cumprir regras (aprova\xe7\xe3o manual ou tempo de espera). Isso cria barreira adicional antes de deploy cr\xedtico."]}),"\n",(0,r.jsx)(s.h3,{id:"erros-e-armadilhas-frequentes",children:"Erros e Armadilhas Frequentes"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Esquecer de referenciar environment -> secrets daquele environment n\xe3o aparecem."}),"\n",(0,r.jsx)(s.li,{children:"Concatena\xe7\xe3o que divide secret em peda\xe7os pode desmascarar padr\xf5es parciais."}),"\n",(0,r.jsxs)(s.li,{children:["Uso de ",(0,r.jsx)(s.code,{children:"echo ${{ secrets.MEU_TOKEN }}"})," em plain log sem necessidade."]}),"\n",(0,r.jsxs)(s.li,{children:["Confundir ",(0,r.jsx)(s.code,{children:"secrets"})," com ",(0,r.jsx)(s.code,{children:"vars"})," e tentar alterar secret dentro do workflow (n\xe3o suportado; secrets s\xe3o somente leitura em runtime)."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"exemplo-pr\xe1tico",children:"Exemplo Pr\xe1tico"}),"\n",(0,r.jsx)(s.p,{children:"Workflow demonstrando uso coordenado de secrets e variables:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'name: Build Parametrizado\non: [push]\n\npermissions:\n  contents: read\n\nenv:\n  REGIAO_DEFAULT: us-east-1\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    environment: staging\n    steps:\n      - uses: actions/checkout@v4\n      - name: Mostrar par\xe2metros\n        run: |\n          echo "Aplica\xe7\xe3o: ${{ vars.NOME_APLICACAO }}"\n          echo "Regi\xe3o default: $REGIAO_DEFAULT"\n      - name: Usar secret em chamada de API\n        run: |\n          curl -H "Authorization: Bearer ${{ secrets.API_BACKEND_KEY }}" https://api.exemplo.local/status || true\n      - name: Exportar vari\xe1vel derivada\n        run: echo "ENDPOINT=https://api.${{ vars.DOMINIO_BASE }}" >> $GITHUB_ENV\n      - name: Consumir vari\xe1vel derivada\n        run: echo "Endpoint calculado: $ENDPOINT"\n'})}),"\n",(0,r.jsx)(s.p,{children:"Pr\xe9-condi\xe7\xf5es:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Definir em reposit\xf3rio: Variables ",(0,r.jsx)(s.code,{children:"NOME_APLICACAO"}),", ",(0,r.jsx)(s.code,{children:"DOMINIO_BASE"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Definir em Environment ",(0,r.jsx)(s.code,{children:"staging"}),": Secret ",(0,r.jsx)(s.code,{children:"API_BACKEND_KEY"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,r.jsxs)(s.p,{children:["Secrets e variables cumprem pap\xe9is complementares: seguran\xe7a para credenciais x parametriza\xe7\xe3o transparente n\xe3o sens\xedvel. Separar usos evita exposi\xe7\xe3o acidental e melhora manuten\xe7\xe3o. Dominar escopos, preced\xeancia e intera\xe7\xe3o com environments permite aplicar princ\xedpio do menor privil\xe9gio de forma pr\xe1tica. A seguir, pode-se evoluir para: pol\xedtica de rota\xe7\xe3o, diferencia\xe7\xe3o detalhada ",(0,r.jsx)(s.code,{children:"GITHUB_TOKEN"})," vs secrets personalizados ou estrat\xe9gias de valida\xe7\xe3o de integridade antes de deploy. Indique a pr\xf3xima prioridade."]})]})}function m(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>a,x:()=>c});var o=i(6540);const r={},n=o.createContext(r);function a(e){const s=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(n.Provider,{value:s},e.children)}}}]);