"use strict";(globalThis.webpackChunkdevops_automation_site=globalThis.webpackChunkdevops_automation_site||[]).push([[8702],{4672:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>d,contentTitle:()=>t,default:()=>l,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"modulo-04-avancado/env-proc","title":"Environments e Prote\xe7\xf5es de Implanta\xe7\xe3o","description":"Introdu\xe7\xe3o","source":"@site/curso-github-actions-udemy/modulo-04-avancado/04-env-protecoes.md","sourceDirName":"modulo-04-avancado","slug":"/modulo-04-avancado/env-proc","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/env-proc","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"env-proc","title":"Environments e Prote\xe7\xf5es de Implanta\xe7\xe3o"},"sidebar":"tutorialSidebar","previous":{"title":"Contextos e Express\xf5es no GitHub Actions (Fundamentos)","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/contex-exp"},"next":{"title":"Matriz e Concorr\xeancia","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/matrix-conc"}}');var r=n(4848),s=n(8453);const i={id:"env-proc",title:"Environments e Prote\xe7\xf5es de Implanta\xe7\xe3o"},t="Environments e Prote\xe7\xf5es de Implanta\xe7\xe3o",d={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Defini\xe7\xe3o",id:"defini\xe7\xe3o",level:2},{value:"Explica\xe7\xe3o T\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Exemplo",id:"exemplo",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function m(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.header,{children:(0,r.jsx)(o.h1,{id:"environments-e-prote\xe7\xf5es-de-implanta\xe7\xe3o",children:"Environments e Prote\xe7\xf5es de Implanta\xe7\xe3o"})}),"\n",(0,r.jsx)(o.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,r.jsx)(o.p,{children:"Environments organizam implanta\xe7\xf5es por est\xe1gios (como dev, staging e prod), segregando vari\xe1veis e segredos e aplicando prote\xe7\xf5es antes de liberar o deploy. Usar environments corretamente ajuda a evitar exposi\xe7\xf5es indevidas e cria um fluxo de promo\xe7\xe3o previs\xedvel com aprova\xe7\xf5es e janelas de espera."}),"\n",(0,r.jsx)(o.h2,{id:"defini\xe7\xe3o",children:"Defini\xe7\xe3o"}),"\n",(0,r.jsx)(o.p,{children:"Um environment \xe9 um alvo l\xf3gico de implanta\xe7\xe3o no GitHub que pode possuir vari\xe1veis, segredos e regras de prote\xe7\xe3o. Ao declarar um environment em um job, voc\xea habilita o acesso aos segredos daquele est\xe1gio e pode exigir aprova\xe7\xf5es manuais antes da execu\xe7\xe3o. Tamb\xe9m \xe9 poss\xedvel definir uma URL de ambiente para sinalizar onde o sistema est\xe1 dispon\xedvel ap\xf3s o deploy."}),"\n",(0,r.jsx)(o.p,{children:"Link oficial:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["Environments (gerenciamento e prote\xe7\xe3o): ",(0,r.jsx)(o.a,{href:"https://docs.github.com/pt/actions/deployment/targeting-different-environments/managing-environments-for-deployment",children:"https://docs.github.com/pt/actions/deployment/targeting-different-environments/managing-environments-for-deployment"})]}),"\n"]}),"\n",(0,r.jsx)(o.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o T\xe9cnica"}),"\n",(0,r.jsxs)(o.p,{children:["Voc\xea declara o environment no trabalho com ",(0,r.jsx)(o.code,{children:"environment:"}),". Quando um environment possui regras de prote\xe7\xe3o, o trabalho entra em estado de \u201caguardando aprova\xe7\xe3o\u201d at\xe9 que um revisor autorizado libere a execu\xe7\xe3o. Al\xe9m disso, a configura\xe7\xe3o pode incluir um tempo de espera (wait timer), janelas de implanta\xe7\xe3o e escopos de acesso aos segredos espec\xedficos daquele environment."]}),"\n",(0,r.jsxs)(o.p,{children:["A segrega\xe7\xe3o por environment permite que segredos e vari\xe1veis sejam diferentes por est\xe1gio, mantendo nomes consistentes e reduzindo erros. Por exemplo, ",(0,r.jsx)(o.code,{children:"DATABASE_URL"})," pode ter valores distintos em ",(0,r.jsx)(o.code,{children:"dev"})," e ",(0,r.jsx)(o.code,{children:"prod"}),", mas o workflow referencia apenas ",(0,r.jsx)(o.code,{children:"secrets.DATABASE_URL"})," ap\xf3s ativar o environment correto. A propriedade ",(0,r.jsx)(o.code,{children:"environment"})," aceita tamb\xe9m um campo ",(0,r.jsx)(o.code,{children:"url"}),", permitindo apresentar um link clic\xe1vel no resumo da execu\xe7\xe3o para a aplica\xe7\xe3o implantada."]}),"\n",(0,r.jsx)(o.p,{children:"Boas pr\xe1ticas incluem criar environments com nomes claros (dev, staging, prod), exigir revisores apenas em ambientes sens\xedveis (como prod), restringir permiss\xf5es de escrita e separar os jobs de build/test dos jobs de implanta\xe7\xe3o. Sempre reveja quem pode aprovar e se os segredos est\xe3o realmente armazenados no environment e n\xe3o no reposit\xf3rio de forma global."}),"\n",(0,r.jsx)(o.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,r.jsx)(o.p,{children:"O exemplo a seguir demonstra um trabalho que usa um environment com URL e um gate de prote\xe7\xe3o por aprova\xe7\xe3o. \xc9 conceitual e compat\xedvel com executores Linux."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-yaml",children:'name: Aula 20 \u2014 Environments e Prote\xe7\xf5es\non:\n  workflow_dispatch:\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    environment:\n      name: prod\n      url: https://app.exemplo.com\n    steps:\n      - name: Preparar pacote\n        run: |\n          echo "Gerando artefatos de deploy..."\n      - name: Usar segredos do environment (ap\xf3s aprova\xe7\xe3o)\n        env:\n          DATABASE_URL: ${{ secrets.DATABASE_URL }}\n        run: |\n          echo "Conectando ao banco com URL protegida (valor n\xe3o impresso)"\n          # Exemplo: ./deploy.sh --db "${DATABASE_URL}"\n      - name: Finalizar\n        run: |\n          echo "Implanta\xe7\xe3o conclu\xedda em ${GITHUB_REF_NAME:-branch}" \n'})}),"\n",(0,r.jsxs)(o.p,{children:["Como funciona: ao iniciar o trabalho, caso o environment ",(0,r.jsx)(o.code,{children:"prod"})," tenha revisores obrigat\xf3rios, a execu\xe7\xe3o ficar\xe1 em espera at\xe9 a aprova\xe7\xe3o. Depois disso, os segredos do environment ficam dispon\xedveis e podem ser consumidos com seguran\xe7a nas etapas. A ",(0,r.jsx)(o.code,{children:"url"})," definida no environment aparece no resumo da execu\xe7\xe3o como o endere\xe7o da aplica\xe7\xe3o implantada."]}),"\n",(0,r.jsx)(o.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,r.jsx)(o.p,{children:"Environments trazem segrega\xe7\xe3o de configura\xe7\xe3o por est\xe1gio e mecanismos de prote\xe7\xe3o como aprova\xe7\xf5es e janelas de espera. Declarar o environment diretamente no job libera segredos daquele est\xe1gio e permite exibir a URL do ambiente ap\xf3s o deploy. Com nomes padronizados, revisores definidos e segredos bem distribu\xeddos, o pipeline fica mais seguro, audit\xe1vel e f\xe1cil de operar."})]})}function l(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},8453:(e,o,n)=>{n.d(o,{R:()=>i,x:()=>t});var a=n(6540);const r={},s=a.createContext(r);function i(e){const o=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:o},e.children)}}}]);