"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[5990],{8453:(e,r,a)=>{a.d(r,{R:()=>s,x:()=>i});var o=a(6540);const n={},d=o.createContext(n);function s(e){const r=o.useContext(d);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),o.createElement(d.Provider,{value:r},e.children)}},9104:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"lab-4-fmt-validate","title":"Lab 4 - Mantendo a Qualidade do C\xf3digo com fmt, validate e show no Terraform","description":"Introdu\xe7\xe3o","source":"@site/curso-terraform-udemy/12-lab-fmt-show.md","sourceDirName":".","slug":"/lab-4-fmt-validate","permalink":"/udemy/terraform-automacao/lab-4-fmt-validate","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"id":"lab-4-fmt-validate","title":"Lab 4 - Mantendo a Qualidade do C\xf3digo com fmt, validate e show no Terraform","noindex":true},"sidebar":"tutorialSidebar","previous":{"title":"Lab 3 - Criando Recursos em Lote com count e for_each no Terraform","permalink":"/udemy/terraform-automacao/lab-3-for-each-count"},"next":{"title":"Lab 5 - Utilizando Backend Remoto com Azure Blob Storage no Terraform","permalink":"/udemy/terraform-automacao/lab-5-tfstate-remoto"}}');var n=a(4848),d=a(8453);const s={id:"lab-4-fmt-validate",title:"Lab 4 - Mantendo a Qualidade do C\xf3digo com fmt, validate e show no Terraform",noindex:!0},i="Lab: Mantendo a Qualidade do C\xf3digo com fmt, validate e show no Terraform",l={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",level:2},{value:"Estrutura de Arquivos",id:"estrutura-de-arquivos",level:2},{value:"<code>providers.tf</code>",id:"providerstf",level:2},{value:"C\xf3digo propositalmente mal formatado em <code>main.tf</code>",id:"c\xf3digo-propositalmente-mal-formatado-em-maintf",level:2},{value:"Passo 1: Formatando o C\xf3digo com <code>terraform fmt</code>",id:"passo-1-formatando-o-c\xf3digo-com-terraform-fmt",level:2},{value:"Passo 2: Validando o C\xf3digo com <code>terraform validate</code>",id:"passo-2-validando-o-c\xf3digo-com-terraform-validate",level:2},{value:"C\xf3digo com erro em <code>main.tf</code>",id:"c\xf3digo-com-erro-em-maintf",level:3},{value:"Rodando a valida\xe7\xe3o",id:"rodando-a-valida\xe7\xe3o",level:3},{value:"Sa\xedda esperada",id:"sa\xedda-esperada",level:3},{value:"Corrigindo o erro",id:"corrigindo-o-erro",level:3},{value:"Validando novamente",id:"validando-novamente",level:3},{value:"Sa\xedda esperada",id:"sa\xedda-esperada-1",level:3},{value:"Passo 3: Inspecionando com <code>terraform show</code>",id:"passo-3-inspecionando-com-terraform-show",level:2},{value:"Sa\xedda esperada (exemplo)",id:"sa\xedda-esperada-exemplo",level:3},{value:"Analisando um plano salvo",id:"analisando-um-plano-salvo",level:3},{value:"Boas Pr\xe1ticas",id:"boas-pr\xe1ticas",level:2},{value:"Fluxo de Trabalho Recomendado",id:"fluxo-de-trabalho-recomendado",level:2}];function t(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsxs)(r.h1,{id:"lab-mantendo-a-qualidade-do-c\xf3digo-com-fmt-validate-e-show-no-terraform",children:["Lab: Mantendo a Qualidade do C\xf3digo com ",(0,n.jsx)(r.code,{children:"fmt"}),", ",(0,n.jsx)(r.code,{children:"validate"})," e ",(0,n.jsx)(r.code,{children:"show"})," no Terraform"]})}),"\n",(0,n.jsx)(r.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,n.jsxs)(r.p,{children:["Neste laborat\xf3rio, vamos explorar comandos auxiliares do Terraform que ajudam a manter a qualidade do c\xf3digo: ",(0,n.jsx)(r.code,{children:"terraform fmt"}),", ",(0,n.jsx)(r.code,{children:"terraform validate"})," e ",(0,n.jsx)(r.code,{children:"terraform show"}),". Esses comandos s\xe3o essenciais para manter o c\xf3digo limpo, funcional e f\xe1cil de revisar."]}),"\n",(0,n.jsx)(r.h2,{id:"pr\xe9-requisitos",children:"Pr\xe9-requisitos"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Terraform instalado (vers\xe3o 1.12.2 ou superior)"}),"\n",(0,n.jsxs)(r.li,{children:["Azure CLI autenticada (",(0,n.jsx)(r.code,{children:"az login"}),")"]}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"estrutura-de-arquivos",children:"Estrutura de Arquivos"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"lab-fmt-validate-show/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 providers.tf\n"})}),"\n",(0,n.jsx)(r.h2,{id:"providerstf",children:(0,n.jsx)(r.code,{children:"providers.tf"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'terraform {\n  required_providers {\n    azurerm = {\n      source  = "hashicorp/azurerm"\n      version = "4.35.0"\n    }\n  }\n\n  required_version = ">= 1.12.2"\n}\n\nprovider "azurerm" {\n  features {}\n}\n'})}),"\n",(0,n.jsxs)(r.h2,{id:"c\xf3digo-propositalmente-mal-formatado-em-maintf",children:["C\xf3digo propositalmente mal formatado em ",(0,n.jsx)(r.code,{children:"main.tf"})]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'resource   "azurerm_resource_group"   "rg" {\n   name="meu-grupo"\nlocation="East US"\n}\n'})}),"\n",(0,n.jsxs)(r.h2,{id:"passo-1-formatando-o-c\xf3digo-com-terraform-fmt",children:["Passo 1: Formatando o C\xf3digo com ",(0,n.jsx)(r.code,{children:"terraform fmt"})]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform fmt\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Esse comando reescreve todos os arquivos ",(0,n.jsx)(r.code,{children:".tf"})," com identa\xe7\xe3o padronizada. N\xe3o altera a l\xf3gica do c\xf3digo."]}),"\n",(0,n.jsxs)(r.p,{children:["C\xf3digo ap\xf3s ",(0,n.jsx)(r.code,{children:"fmt"}),":"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'resource "azurerm_resource_group" "rg" {\n  name     = "meu-grupo"\n  location = "East US"\n}\n'})}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"passo-2-validando-o-c\xf3digo-com-terraform-validate",children:["Passo 2: Validando o C\xf3digo com ",(0,n.jsx)(r.code,{children:"terraform validate"})]}),"\n",(0,n.jsxs)(r.h3,{id:"c\xf3digo-com-erro-em-maintf",children:["C\xf3digo com erro em ",(0,n.jsx)(r.code,{children:"main.tf"})]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'resource "azurerm_resource_group" "rg" {\n  nome = "grupo-invalido"\n  location = "East US"\n}\n'})}),"\n",(0,n.jsx)(r.h3,{id:"rodando-a-valida\xe7\xe3o",children:"Rodando a valida\xe7\xe3o"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform validate\n"})}),"\n",(0,n.jsx)(r.h3,{id:"sa\xedda-esperada",children:"Sa\xedda esperada"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-text",children:'\u2502 Error: Unsupported argument\n\u2502   on main.tf line 2, in resource "azurerm_resource_group" "rg":\n\u2502   2:   nome = "grupo-invalido"\n\u2502\n\u2502 An argument named "nome" is not expected here.\n'})}),"\n",(0,n.jsx)(r.h3,{id:"corrigindo-o-erro",children:"Corrigindo o erro"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'resource "azurerm_resource_group" "rg" {\n  name     = "grupo-valido"\n  location = "East US"\n}\n'})}),"\n",(0,n.jsx)(r.h3,{id:"validando-novamente",children:"Validando novamente"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform validate\n"})}),"\n",(0,n.jsx)(r.h3,{id:"sa\xedda-esperada-1",children:"Sa\xedda esperada"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-text",children:"Success! The configuration is valid.\n"})}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.h2,{id:"passo-3-inspecionando-com-terraform-show",children:["Passo 3: Inspecionando com ",(0,n.jsx)(r.code,{children:"terraform show"})]}),"\n",(0,n.jsx)(r.p,{children:"Ap\xf3s rodar:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform init\nterraform apply\n"})}),"\n",(0,n.jsx)(r.p,{children:"Use:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform show\n"})}),"\n",(0,n.jsx)(r.h3,{id:"sa\xedda-esperada-exemplo",children:"Sa\xedda esperada (exemplo)"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-text",children:'# azurerm_resource_group.rg:\nresource "azurerm_resource_group" "rg" {\n  location = "East US"\n  name     = "grupo-valido"\n  id       = "/subscriptions/.../resourceGroups/grupo-valido"\n}\n'})}),"\n",(0,n.jsx)(r.h3,{id:"analisando-um-plano-salvo",children:"Analisando um plano salvo"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform plan -out=tfplan\nterraform show tfplan\n"})}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"boas-pr\xe1ticas",children:"Boas Pr\xe1ticas"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Execute ",(0,n.jsx)(r.code,{children:"terraform fmt"})," antes de commits para manter o c\xf3digo limpo"]}),"\n",(0,n.jsxs)(r.li,{children:["Use ",(0,n.jsx)(r.code,{children:"terraform validate"})," para evitar erros antes do ",(0,n.jsx)(r.code,{children:"plan"})]}),"\n",(0,n.jsxs)(r.li,{children:["Utilize ",(0,n.jsx)(r.code,{children:"terraform show"})," para entender a infraestrutura provisionada"]}),"\n",(0,n.jsx)(r.li,{children:"Inclua esses comandos em pipelines de CI/CD"}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.h2,{id:"fluxo-de-trabalho-recomendado",children:"Fluxo de Trabalho Recomendado"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Escreva ou edite seu c\xf3digo"}),"\n",(0,n.jsxs)(r.li,{children:["Rode ",(0,n.jsx)(r.code,{children:"terraform fmt"})]}),"\n",(0,n.jsxs)(r.li,{children:["Rode ",(0,n.jsx)(r.code,{children:"terraform validate"})]}),"\n",(0,n.jsxs)(r.li,{children:["Rode ",(0,n.jsx)(r.code,{children:"terraform plan"})]}),"\n",(0,n.jsxs)(r.li,{children:["Rode ",(0,n.jsx)(r.code,{children:"terraform apply"})]}),"\n",(0,n.jsxs)(r.li,{children:["Use ",(0,n.jsx)(r.code,{children:"terraform show"})," para inspecionar"]}),"\n"]})]})}function m(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}}}]);