"use strict";(globalThis.webpackChunkdevops_automation_site=globalThis.webpackChunkdevops_automation_site||[]).push([[8431],{4791:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>n,toc:()=>t});const n=JSON.parse('{"id":"modulo-04-avancado/secrets","title":"Secrets & Vari\xe1veis no GitHub Actions","description":"Introdu\xe7\xe3o","source":"@site/curso-github-actions-udemy/modulo-04-avancado/02-Secrets-Variaveis.md","sourceDirName":"modulo-04-avancado","slug":"/modulo-04-avancado/secrets","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/secrets","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"secrets","title":"Secrets & Vari\xe1veis no GitHub Actions"},"sidebar":"tutorialSidebar","previous":{"title":"Github Token","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/github-token"},"next":{"title":"Contextos e Express\xf5es no GitHub Actions (Fundamentos)","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/contex-exp"}}');var r=s(4848),a=s(8453);const i={id:"secrets",title:"Secrets & Vari\xe1veis no GitHub Actions"},c="Vari\xe1veis (env/vars) e Segredos: Escopos e Preced\xeancia",d={},t=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Defini\xe7\xe3o",id:"defini\xe7\xe3o",level:2},{value:"Explica\xe7\xe3o T\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Exemplo",id:"exemplo",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function l(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.header,{children:(0,r.jsx)(o.h1,{id:"vari\xe1veis-envvars-e-segredos-escopos-e-preced\xeancia",children:"Vari\xe1veis (env/vars) e Segredos: Escopos e Preced\xeancia"})}),"\n",(0,r.jsx)(o.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,r.jsx)(o.p,{children:"Vari\xe1veis e segredos s\xe3o a cola que conecta configura\xe7\xf5es do reposit\xf3rio ao seu pipeline. Compreender onde declarar, como herdam valores e quais limita\xe7\xf5es de uso existem evita comportamentos inesperados e reduz riscos de seguran\xe7a. Nesta aula, organizamos env, vars e secrets, com foco em preced\xeancia e uso seguro no YAML e no shell."}),"\n",(0,r.jsx)(o.h2,{id:"defini\xe7\xe3o",children:"Defini\xe7\xe3o"}),"\n",(0,r.jsxs)(o.p,{children:["Vari\xe1veis de ambiente (env) s\xe3o pares chave-valor definidos no workflow, no job ou no step, herdando por escopos. Voc\xea pode referenci\xe1-las como ",(0,r.jsx)(o.code,{children:"${{ env.NOME }}"})," no YAML ou ",(0,r.jsx)(o.code,{children:"$NOME"})," dentro de comandos de shell. J\xe1 as vari\xe1veis do contexto vars s\xe3o gerenciadas pela organiza\xe7\xe3o, pelo reposit\xf3rio ou por ambientes (environments) via interface do GitHub, e servem para valores n\xe3o sens\xedveis. Segredos (secrets) guardam informa\xe7\xf5es confidenciais com mascaramento autom\xe1tico de logs e controle de escopo por organiza\xe7\xe3o, reposit\xf3rio e ambiente."]}),"\n",(0,r.jsx)(o.p,{children:"Links oficiais:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["env (workflow syntax): ",(0,r.jsx)(o.a,{href:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#env",children:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#env"})]}),"\n",(0,r.jsxs)(o.li,{children:["Contextos (vars e secrets): ",(0,r.jsx)(o.a,{href:"https://docs.github.com/pt/actions/learn-github-actions/contexts",children:"https://docs.github.com/pt/actions/learn-github-actions/contexts"})]}),"\n",(0,r.jsxs)(o.li,{children:["Condicionais em steps (if): ",(0,r.jsx)(o.a,{href:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idstepsif",children:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idstepsif"})]}),"\n"]}),"\n",(0,r.jsx)(o.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o T\xe9cnica"}),"\n",(0,r.jsxs)(o.p,{children:["A preced\xeancia de env respeita o escopo mais espec\xedfico: valores definidos no step sobrescrevem os definidos no job, que por sua vez sobrescrevem os do topo do workflow. Essa hierarquia ajuda a definir padr\xf5es gerais e exce\xe7\xf5es pontuais onde necess\xe1rio. No uso, prefira ",(0,r.jsx)(o.code,{children:"${{ env.VAR }}"})," quando preencher campos do YAML e ",(0,r.jsx)(o.code,{children:"$VAR"})," dentro de ",(0,r.jsx)(o.code,{children:"run:"})," em shell, para evitar confus\xe3o entre avalia\xe7\xe3o de express\xf5es e expans\xe3o de vari\xe1veis."]}),"\n",(0,r.jsxs)(o.p,{children:["Para vars, o GitHub oferece n\xedveis hier\xe1rquicos por organiza\xe7\xe3o, reposit\xf3rio e ambiente. Quando um job aponta para um environment, as ",(0,r.jsx)(o.code,{children:"vars"})," desse ambiente prevalecem sobre as do reposit\xf3rio e, por fim, sobre as da organiza\xe7\xe3o. Esse modelo permite que voc\xea defina um mesmo nome (por exemplo, ",(0,r.jsx)(o.code,{children:"APP_ENV"}),") com valores diferentes por ambiente, mantendo consist\xeancia de chaves e reduzindo duplicidade."]}),"\n",(0,r.jsxs)(o.p,{children:["Segredos (secrets) devem ser mapeados para ",(0,r.jsx)(o.code,{children:"env:"})," antes de uso no shell, e nunca devem ser impressos. Em PRs vindos de forks, segredos do reposit\xf3rio n\xe3o s\xe3o disponibilizados; isso protege contra exposi\xe7\xf5es acidentais. Ao reutilizar workflows (",(0,r.jsx)(o.code,{children:"workflow_call"}),"), use ",(0,r.jsx)(o.code,{children:"secrets: inherit"})," com cuidado ou declare explicitamente os segredos aceitos como inputs para manter controle. Em algumas propriedades, como certos usos de ",(0,r.jsx)(o.code,{children:"if"}),", ",(0,r.jsx)(o.code,{children:"secrets"})," pode n\xe3o estar dispon\xedvel; preferencialmente, fa\xe7a gating com ",(0,r.jsx)(o.code,{children:"vars"}),"/",(0,r.jsx)(o.code,{children:"github"})," ou mova a l\xf3gica para o shell, consumindo o segredo via ",(0,r.jsx)(o.code,{children:"env"})," sem ecoar o valor."]}),"\n",(0,r.jsxs)(o.p,{children:["Boas pr\xe1ticas incluem nomear vari\xe1veis de forma clara, centralizar valores n\xe3o sens\xedveis em ",(0,r.jsx)(o.code,{children:"vars"})," e separar segredos por ambiente usando Environments com prote\xe7\xf5es. Evite duplicar valores em muitos lugares; confie na preced\xeancia e documente no topo do arquivo onde cada conjunto \xe9 definido."]}),"\n",(0,r.jsx)(o.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,r.jsx)(o.p,{children:"Este exemplo demonstra a preced\xeancia de env, o uso de vars por ambiente, e o mapeamento seguro de secrets para o shell. \xc9 conceitual e compat\xedvel com executores Linux."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-yaml",children:'name: Aula 19 \u2014 Vari\xe1veis e Segredos\non:\n  workflow_dispatch:\n\nenv:\n  APP_NAME: demo-app            # escopo do workflow\n  LOG_LEVEL: info\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    environment: prod           # ativa vars e secrets do ambiente "prod"\n    env:\n      LOG_LEVEL: warn           # sobrescreve o valor do workflow neste job\n      APP_ENV: ${{ vars.APP_ENV }}  # usa vars do ambiente/repo/org conforme o environment\n    steps:\n      - name: Mostrar env herdado e precedence\n        env:\n          APP_NAME: step-override   # sobrescreve o job/workflow apenas neste step\n        run: |\n          echo "APP_NAME (step): ${APP_NAME}"\n          echo "LOG_LEVEL (job): ${LOG_LEVEL}"\n          echo "APP_ENV (vars): ${APP_ENV:-dev}"\n\n      - name: Mapear segredo para o shell com seguran\xe7a\n        env:\n          API_TOKEN: ${{ secrets.API_TOKEN }}\n        run: |\n          echo "Usando token em chamada (valor n\xe3o impresso)"\n          # Exemplo: curl -H "Authorization: Bearer ${API_TOKEN}" https://api.exemplo.local/health\n          echo "Token est\xe1 mascarado por padr\xe3o e n\xe3o ser\xe1 exibido nos logs"\n\n      - name: Condicional usando vars (evitar secrets diretamente em if)\n        if: ${{ vars.APP_ENV == \'prod\' }}\n        run: |\n          echo "Executando etapa somente em prod"\n'})}),"\n",(0,r.jsxs)(o.p,{children:["O que observar no exemplo: o ",(0,r.jsx)(o.code,{children:"APP_NAME"})," definido no step prevalece apenas naquele step; o ",(0,r.jsx)(o.code,{children:"LOG_LEVEL"})," do job substitui o do workflow no job inteiro; ",(0,r.jsx)(o.code,{children:"APP_ENV"})," vem de ",(0,r.jsx)(o.code,{children:"vars"}),", com preced\xeancia do environment. O segredo ",(0,r.jsx)(o.code,{children:"API_TOKEN"})," \xe9 mapeado para ",(0,r.jsx)(o.code,{children:"env"})," e usado no shell sem impress\xe3o do valor. A condicional ",(0,r.jsx)(o.code,{children:"if"})," utiliza ",(0,r.jsx)(o.code,{children:"vars"})," em vez de ",(0,r.jsx)(o.code,{children:"secrets"})," para evitar indisponibilidade e exposi\xe7\xe3o."]}),"\n",(0,r.jsx)(o.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,r.jsxs)(o.p,{children:["Dominar env, vars e secrets passa por entender onde declarar, como a preced\xeancia se aplica e quando cada um deve ser usado. Defina padr\xf5es no topo do workflow, ajuste no job e, quando necess\xe1rio, no step. Centralize valores n\xe3o sens\xedveis em ",(0,r.jsx)(o.code,{children:"vars"})," e segregue segredos por ambiente, sempre mapeando-os para ",(0,r.jsx)(o.code,{children:"env"})," antes de usar no shell. Com essas pr\xe1ticas, seus workflows ficam previs\xedveis, seguros e f\xe1ceis de manter."]})]})}function p(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,o,s)=>{s.d(o,{R:()=>i,x:()=>c});var n=s(6540);const r={},a=n.createContext(r);function i(e){const o=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(a.Provider,{value:o},e.children)}}}]);