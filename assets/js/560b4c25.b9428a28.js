"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[1292],{1521:(e,o,i)=>{i.r(o),i.d(o,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modulo-04-security/github-token","title":"Github Token","description":"Introdu\xe7\xe3o","source":"@site/curso-github-actions-udemy/modulo-04-security/01-GitHub-Token.md","sourceDirName":"modulo-04-security","slug":"/modulo-04-security/github-token","permalink":"/udemy/github-actions-automacao/modulo-04-security/github-token","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"github-token","title":"Github Token"},"sidebar":"tutorialSidebar","previous":{"title":"Jobs: Paralelo vs Sequencial","permalink":"/udemy/github-actions-automacao/modulo-03-Criando-workflow/jobs"},"next":{"title":"Secrets & Vari\xe1veis no GitHub Actions","permalink":"/udemy/github-actions-automacao/modulo-04-security/secrets"}}');var n=i(4848),r=i(8453);const a={id:"github-token",title:"Github Token"},t="Github Token",d={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Defini\xe7\xe3o",id:"defini\xe7\xe3o",level:2},{value:"Explica\xe7\xe3o T\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Como \xe9 gerado",id:"como-\xe9-gerado",level:3},{value:"Escopo e Permiss\xf5es",id:"escopo-e-permiss\xf5es",level:3},{value:"Ciclo de Vida",id:"ciclo-de-vida",level:3},{value:"Evitando Loops Recursivos",id:"evitando-loops-recursivos",level:3},{value:"Contexto e Acesso",id:"contexto-e-acesso",level:3},{value:"Configura\xe7\xe3o de Permiss\xf5es no Reposit\xf3rio",id:"configura\xe7\xe3o-de-permiss\xf5es-no-reposit\xf3rio",level:3},{value:"Por Que Usar <code>GITHUB_TOKEN</code> em Vez de PAT",id:"por-que-usar-github_token-em-vez-de-pat",level:3},{value:"Limita\xe7\xf5es Importantes",id:"limita\xe7\xf5es-importantes",level:3},{value:"Exemplo Pr\xe1tico",id:"exemplo-pr\xe1tico",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function l(e){const o={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.header,{children:(0,n.jsx)(o.h1,{id:"github-token",children:"Github Token"})}),"\n",(0,n.jsx)(o.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,n.jsxs)(o.p,{children:["O ",(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"})," \xe9 um token de acesso tempor\xe1rio gerado automaticamente pelo GitHub para cada job de um workflow. Ele permite que automa\xe7\xf5es interajam com a pr\xf3pria plataforma sem expor credenciais pessoais ou tokens PAT (Personal Access Token). Compreender seu comportamento, escopo e limita\xe7\xf5es \xe9 essencial para construir automa\xe7\xf5es seguras e previs\xedveis."]}),"\n",(0,n.jsx)(o.h2,{id:"defini\xe7\xe3o",children:"Defini\xe7\xe3o"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"})," \xe9 um segredo ef\xeamero (installation access token de um GitHub App interno) emitido no in\xedcio de cada job, com permiss\xf5es associadas ao reposit\xf3rio onde o workflow est\xe1 sendo executado. Expira ao final da execu\xe7\xe3o do job (ou no m\xe1ximo em 24h). Ele est\xe1 dispon\xedvel tanto como vari\xe1vel de ambiente quanto via contexto ",(0,n.jsx)(o.code,{children:"github.token"})," dentro do workflow."]}),"\n",(0,n.jsx)(o.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o T\xe9cnica"}),"\n",(0,n.jsx)(o.h3,{id:"como-\xe9-gerado",children:"Como \xe9 gerado"}),"\n",(0,n.jsxs)(o.p,{children:["Ao habilitar GitHub Actions, um GitHub App \xe9 instalado no reposit\xf3rio. No in\xedcio de cada job, GitHub solicita um installation access token desse App e o injeta no ambiente como ",(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"}),". O token \xe9 \xfanico por job e n\xe3o reutiliz\xe1vel posteriormente."]}),"\n",(0,n.jsx)(o.h3,{id:"escopo-e-permiss\xf5es",children:"Escopo e Permiss\xf5es"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Restringe-se ao reposit\xf3rio atual (n\xe3o acessa outros reposit\xf3rios exceto quando permiss\xf5es e configura\xe7\xf5es espec\xedficas permitem via reutiliza\xe7\xe3o limitada, como checkout de subm\xf3dulos p\xfablicos)."}),"\n",(0,n.jsx)(o.li,{children:"As permiss\xf5es padr\xe3o podem variar (lidas ou reduzidas) conforme configura\xe7\xf5es de organiza\xe7\xe3o ou reposit\xf3rio (ex: pol\xedtica \u201cWorkflow permissions\u201d)."}),"\n",(0,n.jsxs)(o.li,{children:["Pode ser ajustado explicitamente em cada workflow usando a chave ",(0,n.jsx)(o.code,{children:"permissions:"})," para princ\xedpio do menor privil\xe9gio."]}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:"Exemplo de restri\xe7\xe3o expl\xedcita:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-yaml",children:"permissions:\n  contents: read\n  pull-requests: write\n  issues: write\n"})}),"\n",(0,n.jsx)(o.h3,{id:"ciclo-de-vida",children:"Ciclo de Vida"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Criado: antes do primeiro step de cada job."}),"\n",(0,n.jsx)(o.li,{children:"Uso: autentica\xe7\xe3o em API, checkout de c\xf3digo, cria\xe7\xe3o de pull request, coment\xe1rios, atualiza\xe7\xe3o de status, escrita controlada."}),"\n",(0,n.jsx)(o.li,{children:"Expira\xe7\xe3o: ao t\xe9rmino do job ou 24h (o que ocorrer primeiro)."}),"\n",(0,n.jsx)(o.li,{children:"Revoga\xe7\xe3o antecipada: reiniciar job gera novo token, invalidando o anterior."}),"\n"]}),"\n",(0,n.jsx)(o.h3,{id:"evitando-loops-recursivos",children:"Evitando Loops Recursivos"}),"\n",(0,n.jsxs)(o.p,{children:["A\xe7\xf5es disparadas com este token n\xe3o geram novos disparos de workflow para a maioria dos eventos (exce\xe7\xf5es not\xe1veis: ",(0,n.jsx)(o.code,{children:"workflow_dispatch"}),", ",(0,n.jsx)(o.code,{children:"repository_dispatch"}),"). Isso previne loops (ex: workflow que faz ",(0,n.jsx)(o.code,{children:"git push"})," n\xe3o dispara outro workflow de ",(0,n.jsx)(o.code,{children:"push"}),"). Commits feitos usando este token tamb\xe9m n\xe3o acionam build de GitHub Pages."]}),"\n",(0,n.jsx)(o.h3,{id:"contexto-e-acesso",children:"Contexto e Acesso"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["Dispon\xedvel como vari\xe1vel de ambiente autom\xe1tica: ",(0,n.jsx)(o.code,{children:"$GITHUB_TOKEN"})," (dependendo do runner/shell)"]}),"\n",(0,n.jsxs)(o.li,{children:["Dispon\xedvel via express\xe3o: ",(0,n.jsx)(o.code,{children:"${{ github.token }}"})]}),"\n",(0,n.jsx)(o.li,{children:"N\xe3o aparece em logs (mas tenha cuidado ao imprimir estruturas que contenham headers de autoriza\xe7\xe3o)"}),"\n"]}),"\n",(0,n.jsx)(o.h3,{id:"configura\xe7\xe3o-de-permiss\xf5es-no-reposit\xf3rio",children:"Configura\xe7\xe3o de Permiss\xf5es no Reposit\xf3rio"}),"\n",(0,n.jsx)(o.p,{children:"Em Settings > Actions > General > Workflow permissions: pode-se definir"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:(0,n.jsx)(o.code,{children:"Read and write permissions"})}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"Read repository contents permission"}),"\nE opcionalmente habilitar: \u201cAllow GitHub Actions to create and approve pull requests\u201d. Ajustar isso altera o baseline das permiss\xf5es iniciais do token."]}),"\n"]}),"\n",(0,n.jsxs)(o.h3,{id:"por-que-usar-github_token-em-vez-de-pat",children:["Por Que Usar ",(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"})," em Vez de PAT"]}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Rota\xe7\xe3o autom\xe1tica (sem gest\xe3o manual de expira\xe7\xe3o)"}),"\n",(0,n.jsx)(o.li,{children:"Escopo m\xednimo pr\xe9-definido"}),"\n",(0,n.jsx)(o.li,{children:"Menor risco em caso de vazamento (expira r\xe1pido)"}),"\n",(0,n.jsx)(o.li,{children:"Auditabilidade centralizada"}),"\n",(0,n.jsx)(o.li,{children:"Evita depend\xeancia de usu\xe1rio humano para automa\xe7\xf5es estruturais"}),"\n"]}),"\n",(0,n.jsx)(o.h3,{id:"limita\xe7\xf5es-importantes",children:"Limita\xe7\xf5es Importantes"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"N\xe3o reutiliz\xe1vel fora do contexto do job atual"}),"\n",(0,n.jsx)(o.li,{children:"N\xe3o adequado para acesso a recursos externos que exigem credenciais persistentes"}),"\n",(0,n.jsxs)(o.li,{children:["Pode ter permiss\xf5es reduzidas por pol\xedtica organizacional (ex: desabilitar grava\xe7\xe3o em ",(0,n.jsx)(o.code,{children:"pull_requests"}),")"]}),"\n",(0,n.jsx)(o.li,{children:"N\xe3o dispara workflows para eventos originados por suas pr\xf3prias a\xe7\xf5es (preven\xe7\xe3o de recurs\xe3o)"}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"exemplo-pr\xe1tico",children:"Exemplo Pr\xe1tico"}),"\n",(0,n.jsx)(o.p,{children:"Exemplo m\xednimo de uso expl\xedcito com ajuste de permiss\xf5es:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-yaml",children:'name: Exemplo GITHUB_TOKEN\non: [push]\n\npermissions:\n  contents: write\n  pull-requests: write\n\njobs:\n  demo:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - name: Criar arquivo e commit\n        run: |\n          echo "timestamp=$(date -u)" >> build-info.txt\n          git config user.name "github-actions"\n          git config user.email "github-actions@github.com"\n          git add build-info.txt\n          git commit -m "chore: adiciona build-info"\n          git push\n      - name: Chamada \xe0 API\n        run: |\n          curl -H "Authorization: Bearer ${{ github.token }}" \\\n               -H "Accept: application/vnd.github+json" \\\n               https://api.github.com/repos/${{ github.repository }}\n'})}),"\n",(0,n.jsx)(o.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"})," oferece autentica\xe7\xe3o segura, ef\xeamera e integrada ao contexto do reposit\xf3rio, reduzindo necessidade de segredos manuais e diminuindo risco operacional. Dominar seu ciclo de vida, escopo e limita\xe7\xf5es \xe9 passo fundamental antes de introduzir segredos personalizados ou integra\xe7\xf5es externas mais sens\xedveis. Se desejar, podemos avan\xe7ar para: diferencia\xe7\xe3o entre ",(0,n.jsx)(o.code,{children:"GITHUB_TOKEN"})," e tokens cl\xe1ssicos (PAT), ou aplica\xe7\xe3o de princ\xedpio de menor privil\xe9gio em m\xfaltiplos jobs. Indique a pr\xf3xima dire\xe7\xe3o."]})]})}function u(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,o,i)=>{i.d(o,{R:()=>a,x:()=>t});var s=i(6540);const n={},r=s.createContext(n);function a(e){const o=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(r.Provider,{value:o},e.children)}}}]);