"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[5739],{1698:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>t,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"lab-9-locals","title":"Lab 9 - Criando uma Storage Account no Azure com uso de `locals`","description":"Introdu\xe7\xe3o","source":"@site/curso-terraform-udemy/27-lab-locals.md","sourceDirName":".","slug":"/lab-9-locals","permalink":"/udemy/terraform-automacao/lab-9-locals","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":27,"frontMatter":{"id":"lab-9-locals","title":"Lab 9 - Criando uma Storage Account no Azure com uso de `locals`","noindex":true},"sidebar":"tutorialSidebar","previous":{"title":"Lab 8 - Criando uma Storage Account no Azure usando Terraform Workspaces","permalink":"/udemy/terraform-automacao/lab-8-ws"},"next":{"title":"Aula 11 - Introdu\xe7\xe3o ao Shift Left Security e SAST com Terraform","permalink":"/udemy/terraform-automacao/trivy-teorico"}}');var n=o(4848),s=o(8453);const i={id:"lab-9-locals",title:"Lab 9 - Criando uma Storage Account no Azure com uso de `locals`",noindex:!0},l="Lab: Criando uma Storage Account no Azure com uso de locals",t={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",level:2},{value:"Etapas Iniciais",id:"etapas-iniciais",level:2},{value:"Arquivo: provider.tf",id:"arquivo-providertf",level:2},{value:"Arquivo: variables.tf",id:"arquivo-variablestf",level:2},{value:"Arquivo: main.tf",id:"arquivo-maintf",level:2},{value:"Arquivo: outputs.tf",id:"arquivo-outputstf",level:2},{value:"Comandos Terraform",id:"comandos-terraform",level:2},{value:"Resultado Esperado",id:"resultado-esperado",level:2},{value:"Destruindo os Recursos",id:"destruindo-os-recursos",level:2},{value:"Dicas e Boas Pr\xe1ticas",id:"dicas-e-boas-pr\xe1ticas",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsxs)(r.h1,{id:"lab-criando-uma-storage-account-no-azure-com-uso-de-locals",children:["Lab: Criando uma Storage Account no Azure com uso de ",(0,n.jsx)(r.code,{children:"locals"})]})}),"\n",(0,n.jsx)(r.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,n.jsxs)(r.p,{children:["Neste laborat\xf3rio, vamos criar uma Storage Account no Azure utilizando ",(0,n.jsx)(r.strong,{children:"Terraform 1.12.2"})," com o recurso ",(0,n.jsx)(r.code,{children:"locals"})," para deixar o c\xf3digo mais limpo e reutiliz\xe1vel. Essa abordagem facilita a constru\xe7\xe3o de nomes din\xe2micos e evita repeti\xe7\xf5es."]}),"\n",(0,n.jsx)(r.h2,{id:"pr\xe9-requisitos",children:"Pr\xe9-requisitos"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Terraform 1.12.2 instalado"}),"\n",(0,n.jsxs)(r.li,{children:["Conta Azure autenticada com ",(0,n.jsx)(r.code,{children:"az login"})]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"etapas-iniciais",children:"Etapas Iniciais"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Crie o diret\xf3rio e entre nele:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"mkdir lab-storage-locals && cd lab-storage-locals\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"2",children:["\n",(0,n.jsx)(r.li,{children:"Crie os arquivos principais:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"touch main.tf variables.tf outputs.tf provider.tf\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"3",children:["\n",(0,n.jsx)(r.li,{children:"Estrutura esperada:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"lab-storage-locals/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u251c\u2500\u2500 outputs.tf\n\u251c\u2500\u2500 provider.tf\n"})}),"\n",(0,n.jsx)(r.h2,{id:"arquivo-providertf",children:"Arquivo: provider.tf"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'provider "azurerm" {\n  features {}\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"arquivo-variablestf",children:"Arquivo: variables.tf"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'variable "environment" {\n  description = "Ambiente de implanta\xe7\xe3o"\n  default     = "dev"\n}\n\nvariable "location" {\n  description = "Localiza\xe7\xe3o dos recursos"\n  default     = "eastus"\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"arquivo-maintf",children:"Arquivo: main.tf"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'locals {\n  resource_prefix = "app-${var.environment}"\n  rg_name         = "${local.resource_prefix}-rg"\n  sa_name         = "st${var.environment}${substr(md5(var.environment), 0, 4)}"\n}\n\nresource "azurerm_resource_group" "rg" {\n  name     = local.rg_name\n  location = var.location\n}\n\nresource "azurerm_storage_account" "storage" {\n  name                     = local.sa_name\n  resource_group_name      = azurerm_resource_group.rg.name\n  location                 = var.location\n  account_tier             = "Standard"\n  account_replication_type = "LRS"\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"arquivo-outputstf",children:"Arquivo: outputs.tf"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terraform",children:'output "storage_account_name" {\n  value = azurerm_storage_account.storage.name\n}\n\noutput "resource_group_name" {\n  value = azurerm_resource_group.rg.name\n}\n\noutput "environment" {\n  value = var.environment\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"comandos-terraform",children:"Comandos Terraform"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform init\nterraform plan\nterraform apply\n"})}),"\n",(0,n.jsx)(r.h2,{id:"resultado-esperado",children:"Resultado Esperado"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Grupo de recursos e storage account criados com nomes baseados nos ",(0,n.jsx)(r.code,{children:"locals"})]}),"\n",(0,n.jsxs)(r.li,{children:["Exemplo de nomes:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Resource Group: ",(0,n.jsx)(r.code,{children:"app-dev-rg"})]}),"\n",(0,n.jsxs)(r.li,{children:["Storage Account: ",(0,n.jsx)(r.code,{children:"stdevxxxx"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"destruindo-os-recursos",children:"Destruindo os Recursos"}),"\n",(0,n.jsx)(r.p,{children:"Para remover todos os recursos criados pelo Terraform:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"terraform destroy\n"})}),"\n",(0,n.jsx)(r.h2,{id:"dicas-e-boas-pr\xe1ticas",children:"Dicas e Boas Pr\xe1ticas"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Use ",(0,n.jsx)(r.code,{children:"locals"})," para centralizar nomes, sufixos, prefixos ou express\xf5es reutilizadas"]}),"\n",(0,n.jsx)(r.li,{children:"Evite hardcode de nomes e repeti\xe7\xf5es em m\xfaltiplos blocos"}),"\n",(0,n.jsxs)(r.li,{children:["Mantenha os ",(0,n.jsx)(r.code,{children:"locals"})," simples e nomeados claramente"]}),"\n"]}),"\n",(0,n.jsx)(r.hr,{}),"\n",(0,n.jsxs)(r.p,{children:["Este lab mostra como usar ",(0,n.jsx)(r.code,{children:"locals"})," no Terraform para organizar melhor o c\xf3digo e gerar nomes din\xe2micos reutiliz\xe1veis."]})]})}function u(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,r,o)=>{o.d(r,{R:()=>i,x:()=>l});var a=o(6540);const n={},s=a.createContext(n);function i(e){const r=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);