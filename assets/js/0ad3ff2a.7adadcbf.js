"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[5218],{7561:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"workspaces","title":"Aula 9 - Workspaces no Terraform","description":"Introdu\xe7\xe3o","source":"@site/curso-terraform-udemy/16-workspaces.md","sourceDirName":".","slug":"/workspaces","permalink":"/udemy/terraform-automacao/workspaces","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"id":"workspaces","title":"Aula 9 - Workspaces no Terraform","noindex":true},"sidebar":"tutorialSidebar","previous":{"title":"Aula 8 - Arquivos .tfvars no Terraform","permalink":"/udemy/terraform-automacao/tfvars"},"next":{"title":"Aula 10 - Vari\xe1veis `locals` no Terraform","permalink":"/udemy/terraform-automacao/locals"}}');var s=o(4848),n=o(8453);const i={id:"workspaces",title:"Aula 9 - Workspaces no Terraform",noindex:!0},c="Workspaces no Terraform",t={},d=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"O que \xe9 um Workspace",id:"o-que-\xe9-um-workspace",level:2},{value:"Explica\xe7\xe3o t\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Comandos",id:"comandos",level:2},{value:"Exemplo pr\xe1tico",id:"exemplo-pr\xe1tico",level:2},{value:"<code>main.tf</code>",id:"maintf",level:3},{value:"Etapas no terminal",id:"etapas-no-terminal",level:3},{value:"Output esperado",id:"output-esperado",level:2},{value:"Melhores pr\xe1ticas",id:"melhores-pr\xe1ticas",level:2}];function l(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"workspaces-no-terraform",children:"Workspaces no Terraform"})}),"\n",(0,s.jsx)(r.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,s.jsxs)(r.p,{children:["Os ",(0,s.jsx)(r.strong,{children:"workspaces"})," no Terraform permitem que voc\xea utilize o mesmo conjunto de c\xf3digo para gerenciar v\xe1rios ambientes de forma isolada, como ",(0,s.jsx)(r.code,{children:"dev"}),", ",(0,s.jsx)(r.code,{children:"hml"})," e ",(0,s.jsx)(r.code,{children:"prod"}),". Cada workspace possui seu pr\xf3prio estado independente, o que evita conflitos entre ambientes."]}),"\n",(0,s.jsx)(r.p,{children:"Essa abordagem \xe9 muito \xfaltil quando voc\xea quer reaproveitar a mesma infraestrutura, mas separando os dados e aplica\xe7\xf5es por ambiente."}),"\n",(0,s.jsx)(r.h2,{id:"o-que-\xe9-um-workspace",children:"O que \xe9 um Workspace"}),"\n",(0,s.jsxs)(r.p,{children:["Um workspace \xe9 uma inst\xe2ncia do estado do Terraform. Por padr\xe3o, voc\xea est\xe1 no workspace ",(0,s.jsx)(r.code,{children:"default"}),". Ao criar novos workspaces, o Terraform cria um estado separado para cada um, permitindo gerenciar recursos distintos com o mesmo c\xf3digo."]}),"\n",(0,s.jsx)(r.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o t\xe9cnica"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Cada workspace \xe9 associado a um arquivo de estado independente"}),"\n",(0,s.jsxs)(r.li,{children:["O nome do workspace pode ser usado dentro do c\xf3digo com ",(0,s.jsx)(r.code,{children:"terraform.workspace"})]}),"\n",(0,s.jsx)(r.li,{children:"Ideal para projetos pequenos ou m\xe9dios com ambientes bem separados"}),"\n",(0,s.jsx)(r.li,{children:"N\xe3o \xe9 substituto de reposit\xf3rios ou pipelines separados, mas \xe9 uma op\xe7\xe3o v\xe1lida para organizar estados"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"comandos",children:"Comandos"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"terraform workspace list\nterraform workspace new dev\nterraform workspace new hml\nterraform workspace new prod\n\nterraform workspace select dev\nterraform plan\nterraform apply\n"})}),"\n",(0,s.jsx)(r.h2,{id:"exemplo-pr\xe1tico",children:"Exemplo pr\xe1tico"}),"\n",(0,s.jsx)(r.h3,{id:"maintf",children:(0,s.jsx)(r.code,{children:"main.tf"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'variable "location" {\n  default = "eastus"\n}\n\nprovider "azurerm" {\n  features {}\n}\n\nresource "azurerm_resource_group" "rg" {\n  name     = "rg-${terraform.workspace}"\n  location = var.location\n}\n'})}),"\n",(0,s.jsx)(r.h3,{id:"etapas-no-terminal",children:"Etapas no terminal"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"terraform init\nterraform workspace new dev\nterraform apply\n\nterraform workspace new prod\nterraform apply\n"})}),"\n",(0,s.jsx)(r.h2,{id:"output-esperado",children:"Output esperado"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'Apply complete! Resources: 1 added, 0 changed, 0 destroyed.\n\nOutputs:\nazurerm_resource_group.rg:\n  name     = "rg-dev"\n  location = "eastus"\n'})}),"\n",(0,s.jsxs)(r.p,{children:["Ao mudar para o workspace ",(0,s.jsx)(r.code,{children:"prod"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'Apply complete! Resources: 1 added, 0 changed, 0 destroyed.\n\nOutputs:\nazurerm_resource_group.rg:\n  name     = "rg-prod"\n  location = "eastus"\n'})}),"\n",(0,s.jsx)(r.h2,{id:"melhores-pr\xe1ticas",children:"Melhores pr\xe1ticas"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Use nomes consistentes para ambientes (",(0,s.jsx)(r.code,{children:"dev"}),", ",(0,s.jsx)(r.code,{children:"hml"}),", ",(0,s.jsx)(r.code,{children:"prod"}),")"]}),"\n",(0,s.jsxs)(r.li,{children:["Sempre verifique o workspace ativo com ",(0,s.jsx)(r.code,{children:"terraform workspace show"})]}),"\n",(0,s.jsxs)(r.li,{children:["Combine com ",(0,s.jsx)(r.code,{children:"terraform.workspace"})," no c\xf3digo para diferenciar recursos"]}),"\n",(0,s.jsx)(r.li,{children:"N\xe3o use workspaces para isola\xe7\xe3o de times ou projetos distintos"}),"\n",(0,s.jsx)(r.li,{children:"Evite misturar com backends que j\xe1 segmentam por ambiente (como buckets separados)"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Workspaces s\xe3o \xf3timos aliados quando voc\xea precisa reaproveitar c\xf3digo com ambientes diferentes sem complicar a estrutura do projeto."})]})}function p(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,r,o)=>{o.d(r,{R:()=>i,x:()=>c});var a=o(6540);const s={},n=a.createContext(s);function i(e){const r=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(n.Provider,{value:r},e.children)}}}]);