"use strict";(globalThis.webpackChunkdevops_automation_site=globalThis.webpackChunkdevops_automation_site||[]).push([[7378],{3282:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>l,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"99-projeto-final-fala","title":"Lab Final - Guia de Explica\xe7\xe3o para Grava\xe7\xe3o - Azure VM Infrastructure","description":"versions.tf","source":"@site/curso-terraform-udemy/99-projeto-final_fala.md","sourceDirName":".","slug":"/99-projeto-final-fala","permalink":"/udemy/terraform-automacao/99-projeto-final-fala","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":99,"frontMatter":{"id":"99-projeto-final-fala","title":"Lab Final - Guia de Explica\xe7\xe3o para Grava\xe7\xe3o - Azure VM Infrastructure","noindex":true}}');var o=a(4848),i=a(8453);const s={id:"99-projeto-final-fala",title:"Lab Final - Guia de Explica\xe7\xe3o para Grava\xe7\xe3o - Azure VM Infrastructure",noindex:!0},t="Projeto Final Terraform - Guia de Explica\xe7\xe3o com Coment\xe1rios nos Resources",d={},c=[{value:"versions.tf",id:"versionstf",level:2},{value:"main.tf",id:"maintf",level:2},{value:"additional-resources.tf",id:"additional-resourcestf",level:2},{value:"variables.tf",id:"variablestf",level:2},{value:"locals.tf",id:"localstf",level:2},{value:"outputs.tf",id:"outputstf",level:2},{value:"terraform.tfvars",id:"terraformtfvars",level:2},{value:"dev.tfvars",id:"devtfvars",level:2},{value:"prod.tfvars",id:"prodtfvars",level:2},{value:"Comandos de Execu\xe7\xe3o",id:"comandos-de-execu\xe7\xe3o",level:2},{value:"Resumo das Funcionalidades Demonstradas",id:"resumo-das-funcionalidades-demonstradas",level:2},{value:"\u2705 <strong>Variables e Valida\xe7\xe3o</strong>",id:"-variables-e-valida\xe7\xe3o",level:3},{value:"\u2705 <strong>Locals e L\xf3gica Complexa</strong>",id:"-locals-e-l\xf3gica-complexa",level:3},{value:"\u2705 <strong>Outputs Informativos</strong>",id:"-outputs-informativos",level:3},{value:"\u2705 <strong>Count e For Expressions</strong>",id:"-count-e-for-expressions",level:3},{value:"\u2705 <strong>Providers M\xfaltiplos</strong>",id:"-providers-m\xfaltiplos",level:3},{value:"\u2705 <strong>Recursos Condicionais</strong>",id:"-recursos-condicionais",level:3},{value:"\u2705 <strong>Data Sources</strong>",id:"-data-sources",level:3},{value:"\u2705 <strong>Funcionalidades de Produ\xe7\xe3o</strong>",id:"-funcionalidades-de-produ\xe7\xe3o",level:3},{value:"\ud83d\udcb0 <strong>Estimativa de Custos</strong>",id:"-estimativa-de-custos",level:3}];function u(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"projeto-final-terraform---guia-de-explica\xe7\xe3o-com-coment\xe1rios-nos-resources",children:"Projeto Final Terraform - Guia de Explica\xe7\xe3o com Coment\xe1rios nos Resources"})}),"\n",(0,o.jsx)(e.h2,{id:"versionstf",children:"versions.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# Este bloco define as vers\xf5es m\xednimas do Terraform e dos providers necess\xe1rios\n# \xc9 fundamental para garantir compatibilidade e evitar breaking changes\nterraform {\n  required_version = ">= 1.5.0"\n\n  required_providers {\n    # Provider oficial do Azure - permite criar recursos no Azure\n    azurerm = {\n      source  = "hashicorp/azurerm"\n      version = "~> 3.85"\n    }\n    # Provider para gerar valores aleat\xf3rios - usado para nomes \xfanicos de storage\n    random = {\n      source  = "hashicorp/random"\n      version = "~> 3.6"\n    }\n    # Provider para gerar chaves SSH automaticamente\n    tls = {\n      source  = "hashicorp/tls"\n      version = "~> 4.0"\n    }\n    # Provider para recursos baseados em tempo\n    time = {\n      source  = "hashicorp/time"\n      version = "~> 0.10"\n    }\n    # Provider para recursos null (usado para triggers e depend\xeancias)\n    null = {\n      source  = "hashicorp/null"\n      version = "~> 3.2"\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"maintf",children:"main.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# Configura\xe7\xe3o do provider Azure com features espec\xedficas para nosso ambiente\n# Essas configura\xe7\xf5es controlam comportamentos padr\xe3o do provider\nprovider "azurerm" {\n  features {\n    resource_group {\n      # Permite deletar resource group mesmo se contiver recursos (\xfatil para labs)\n      prevent_deletion_if_contains_resources = false\n    }\n    virtual_machine {\n      # Remove discos automaticamente quando VM \xe9 deletada (evita custos extras)\n      delete_os_disk_on_deletion     = true\n      graceful_shutdown              = false\n      skip_shutdown_and_force_delete = false\n    }\n  }\n}\n\n# Data source que obt\xe9m informa\xe7\xf5es da sess\xe3o atual do Azure CLI\n# Usado para pegar tenant_id, subscription_id e object_id automaticamente\ndata "azurerm_client_config" "current" {}\n\n# Resource Group - container l\xf3gico que agrupa todos os recursos relacionados\n# Facilita organiza\xe7\xe3o, billing e aplica\xe7\xe3o de pol\xedticas\nresource "azurerm_resource_group" "main" {\n  name     = local.resource_group_name\n  location = var.location\n\n  tags = local.common_tags\n}\n\n# Virtual Network - rede privada virtual no Azure\n# Define o espa\xe7o de endere\xe7os IP que nossa infraestrutura pode usar\nresource "azurerm_virtual_network" "main" {\n  name                = local.vnet_name\n  address_space       = [var.vnet_address_space]\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  tags = local.common_tags\n}\n\n# Subnet para servidores web - segmenta a rede para melhor seguran\xe7a\n# Servidores web ficam isolados em sua pr\xf3pria subnet\nresource "azurerm_subnet" "web" {\n  name                 = local.web_subnet_name\n  resource_group_name  = azurerm_resource_group.main.name\n  virtual_network_name = azurerm_virtual_network.main.name\n  address_prefixes     = [var.web_subnet_address_prefix]\n}\n\n# Subnet para banco de dados - isolamento adicional para dados sens\xedveis\n# Banco de dados fica em subnet separada com regras de firewall espec\xedficas\nresource "azurerm_subnet" "database" {\n  name                 = local.db_subnet_name\n  resource_group_name  = azurerm_resource_group.main.name\n  virtual_network_name = azurerm_virtual_network.main.name\n  address_prefixes     = [var.db_subnet_address_prefix]\n}\n\n# Network Security Group para subnet web - funciona como firewall de rede\n# Define regras de tr\xe1fego permitido/negado para a subnet web\nresource "azurerm_network_security_group" "web" {\n  name                = local.web_nsg_name\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  # Regra para permitir tr\xe1fego HTTP na porta 80\n  security_rule {\n    name                       = "HTTP"\n    priority                   = 1001\n    direction                  = "Inbound"\n    access                     = "Allow"\n    protocol                   = "Tcp"\n    source_port_range          = "*"\n    destination_port_range     = "80"\n    source_address_prefix      = "*"\n    destination_address_prefix = "*"\n  }\n\n  # Regra para permitir tr\xe1fego HTTPS na porta 443\n  security_rule {\n    name                       = "HTTPS"\n    priority                   = 1002\n    direction                  = "Inbound"\n    access                     = "Allow"\n    protocol                   = "Tcp"\n    source_port_range          = "*"\n    destination_port_range     = "443"\n    source_address_prefix      = "*"\n    destination_address_prefix = "*"\n  }\n\n  # Regra para permitir SSH na porta 22 - restrita por IP de origem\n  security_rule {\n    name                       = "SSH"\n    priority                   = 1003\n    direction                  = "Inbound"\n    access                     = "Allow"\n    protocol                   = "Tcp"\n    source_port_range          = "*"\n    destination_port_range     = "22"\n    source_address_prefix      = var.ssh_source_address_prefix\n    destination_address_prefix = "*"\n  }\n\n  tags = local.common_tags\n}\n\n# Associa\xe7\xe3o do NSG com a subnet web - aplica as regras de firewall \xe0 subnet\nresource "azurerm_subnet_network_security_group_association" "web" {\n  subnet_id                 = azurerm_subnet.web.id\n  network_security_group_id = azurerm_network_security_group.web.id\n}\n\n# Public IPs para as VMs - usando count para criar m\xfaltiplos IPs\n# Cada VM ter\xe1 seu pr\xf3prio IP p\xfablico para acesso direto\nresource "azurerm_public_ip" "main" {\n  count               = var.vm_count\n  name                = "${local.public_ip_name}-${count.index + 1}"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n  allocation_method   = "Dynamic"\n  domain_name_label   = "${local.dns_prefix}-${count.index + 1}"\n\n  tags = local.common_tags\n}\n\n# Load Balancer - recurso condicional criado apenas se h\xe1 m\xfaltiplas VMs\n# Distribui tr\xe1fego entre as VMs para alta disponibilidade\nresource "azurerm_lb" "main" {\n  count               = var.vm_count > 1 ? 1 : 0\n  name                = local.lb_name\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  frontend_ip_configuration {\n    name                 = "PublicIPAddress"\n    public_ip_address_id = azurerm_public_ip.lb[0].id\n  }\n\n  tags = local.common_tags\n}\n\n# Public IP para o Load Balancer - IP est\xe1tico para o LB\nresource "azurerm_public_ip" "lb" {\n  count               = var.vm_count > 1 ? 1 : 0\n  name                = "${local.public_ip_name}-lb"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n  allocation_method   = "Static"\n  sku                = "Standard"\n\n  tags = local.common_tags\n}\n\n# Network Interfaces para as VMs - conecta VMs \xe0 rede\n# Cada VM precisa de sua pr\xf3pria interface de rede\nresource "azurerm_network_interface" "main" {\n  count               = var.vm_count\n  name                = "${local.nic_name}-${count.index + 1}"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  ip_configuration {\n    name                          = "internal"\n    subnet_id                     = azurerm_subnet.web.id\n    private_ip_address_allocation = "Dynamic"\n    public_ip_address_id          = var.vm_count == 1 ? azurerm_public_ip.main[count.index].id : null\n  }\n\n  tags = local.common_tags\n}\n\n# Gera\xe7\xe3o autom\xe1tica de chave SSH - cria par de chaves seguro\n# RSA 4096 bits para m\xe1xima seguran\xe7a de acesso \xe0s VMs\nresource "tls_private_key" "ssh" {\n  algorithm = "RSA"\n  rsa_bits  = 4096\n}\n\n# ID aleat\xf3rio para garantir nome \xfanico da storage account\n# Storage accounts precisam ter nomes globalmente \xfanicos no Azure\nresource "random_id" "storage_suffix" {\n  byte_length = 4\n}\n\n# Storage Account para boot diagnostics das VMs\n# Permite ver console e screenshots das VMs para troubleshooting\nresource "azurerm_storage_account" "boot_diagnostics" {\n  name                     = "${local.storage_account_prefix}${random_id.storage_suffix.hex}"\n  resource_group_name      = azurerm_resource_group.main.name\n  location                 = azurerm_resource_group.main.location\n  account_tier             = "Standard"\n  account_replication_type = "LRS"\n\n  tags = local.common_tags\n}\n\n# Key Vault para armazenar secrets de forma segura\n# Centraliza gerenciamento de chaves, senhas e certificados\nresource "azurerm_key_vault" "main" {\n  name                       = local.key_vault_name\n  location                   = azurerm_resource_group.main.location\n  resource_group_name        = azurerm_resource_group.main.name\n  tenant_id                  = data.azurerm_client_config.current.tenant_id\n  sku_name                   = "standard"\n  soft_delete_retention_days = 7\n\n  # Policy de acesso para o usu\xe1rio atual\n  access_policy {\n    tenant_id = data.azurerm_client_config.current.tenant_id\n    object_id = data.azurerm_client_config.current.object_id\n\n    secret_permissions = [\n      "Get", "List", "Set", "Delete", "Purge"\n    ]\n  }\n\n  tags = local.common_tags\n}\n\n# Armazena a chave SSH privada no Key Vault para acesso seguro\nresource "azurerm_key_vault_secret" "ssh_private_key" {\n  name         = "ssh-private-key"\n  value        = tls_private_key.ssh.private_key_pem\n  key_vault_id = azurerm_key_vault.main.id\n\n  tags = local.common_tags\n}\n\n# Virtual Machines Linux - recurso principal da infraestrutura\n# Cria VMs Ubuntu com autentica\xe7\xe3o via chave SSH\nresource "azurerm_linux_virtual_machine" "main" {\n  count                           = var.vm_count\n  name                            = "${local.vm_name}-${count.index + 1}"\n  location                        = azurerm_resource_group.main.location\n  resource_group_name             = azurerm_resource_group.main.name\n  size                            = var.vm_size\n  admin_username                  = var.admin_username\n  disable_password_authentication = true\n\n  network_interface_ids = [\n    azurerm_network_interface.main[count.index].id,\n  ]\n\n  # Configura\xe7\xe3o da chave SSH para acesso seguro\n  admin_ssh_key {\n    username   = var.admin_username\n    public_key = tls_private_key.ssh.public_key_openssh\n  }\n\n  # Configura\xe7\xe3o do disco do sistema operacional\n  os_disk {\n    caching              = "ReadWrite"\n    storage_account_type = var.os_disk_type\n  }\n\n  # Especifica qual imagem usar para criar a VM\n  source_image_reference {\n    publisher = var.vm_image.publisher\n    offer     = var.vm_image.offer\n    sku       = var.vm_image.sku\n    version   = var.vm_image.version\n  }\n\n  # Habilita boot diagnostics para troubleshooting\n  boot_diagnostics {\n    storage_account_uri = azurerm_storage_account.boot_diagnostics.primary_blob_endpoint\n  }\n\n  depends_on = [\n    tls_private_key.ssh,\n    azurerm_key_vault_secret.ssh_private_key\n  ]\n\n  tags = merge(local.common_tags, {\n    Name = "${local.vm_name}-${count.index + 1}"\n    Tier = "Web"\n  })\n}\n\n# Managed Disks adicionais para dados - separados do disco do OS\n# Boa pr\xe1tica separar dados do sistema operacional\nresource "azurerm_managed_disk" "data" {\n  count                = var.vm_count\n  name                 = "${local.vm_name}-${count.index + 1}-data-disk"\n  location             = azurerm_resource_group.main.location\n  resource_group_name  = azurerm_resource_group.main.name\n  storage_account_type = "Premium_LRS"\n  create_option        = "Empty"\n  disk_size_gb         = var.data_disk_size_gb\n\n  tags = local.common_tags\n}\n\n# Anexa os discos de dados \xe0s VMs correspondentes\nresource "azurerm_virtual_machine_data_disk_attachment" "data" {\n  count              = var.vm_count\n  managed_disk_id    = azurerm_managed_disk.data[count.index].id\n  virtual_machine_id = azurerm_linux_virtual_machine.main[count.index].id\n  lun                = "10"\n  caching            = "ReadWrite"\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"additional-resourcestf",children:"additional-resources.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# Log Analytics Workspace - recurso condicional para monitoring centralizado\n# S\xf3 \xe9 criado se monitoring estiver habilitado na vari\xe1vel\nresource "azurerm_log_analytics_workspace" "main" {\n  count               = var.enable_monitoring ? 1 : 0\n  name                = local.log_analytics_name\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n  sku                 = "PerGB2018"\n  retention_in_days   = 30\n\n  tags = local.common_tags\n}\n\n# VM Extension para instalar agente de monitoramento nas VMs\n# Coleta logs e m\xe9tricas das VMs enviando para Log Analytics\nresource "azurerm_virtual_machine_extension" "log_analytics" {\n  count                = var.enable_monitoring ? var.vm_count : 0\n  name                 = "OmsAgentForLinux"\n  virtual_machine_id   = azurerm_linux_virtual_machine.main[count.index].id\n  publisher            = "Microsoft.EnterpriseCloud.Monitoring"\n  type                 = "OmsAgentForLinux"\n  type_handler_version = "1.13"\n\n  settings = jsonencode({\n    workspaceId = azurerm_log_analytics_workspace.main[0].workspace_id\n  })\n\n  protected_settings = jsonencode({\n    workspaceKey = azurerm_log_analytics_workspace.main[0].primary_shared_key\n  })\n\n  tags = local.common_tags\n}\n\n# Recovery Services Vault - cofre para backup das VMs\n# Recurso condicional criado apenas se backup estiver habilitado\nresource "azurerm_recovery_services_vault" "main" {\n  count               = var.enable_backup ? 1 : 0\n  name                = "${local.naming_prefix}-rsv"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n  sku                 = "Standard"\n  soft_delete_enabled = true\n\n  tags = local.common_tags\n}\n\n# Pol\xedtica de backup para as VMs - define quando e como fazer backup\nresource "azurerm_backup_policy_vm" "main" {\n  count               = var.enable_backup ? 1 : 0\n  name                = "${local.naming_prefix}-backup-policy"\n  resource_group_name = azurerm_resource_group.main.name\n  recovery_vault_name = azurerm_recovery_services_vault.main[0].name\n\n  backup {\n    frequency = "Daily"\n    time      = "23:00"\n  }\n\n  # Reten\xe7\xe3o di\xe1ria dos backups\n  retention_daily {\n    count = var.backup_retention_days\n  }\n\n  # Reten\xe7\xe3o semanal - mant\xe9m backup de domingo por 4 semanas\n  retention_weekly {\n    count    = 4\n    weekdays = ["Sunday"]\n  }\n\n  # Reten\xe7\xe3o mensal - mant\xe9m backup do primeiro domingo por 12 meses\n  retention_monthly {\n    count    = 12\n    weekdays = ["Sunday"]\n    weeks    = ["First"]\n  }\n}\n\n# Prote\xe7\xe3o de backup aplicada \xe0s VMs\n# Liga cada VM \xe0 pol\xedtica de backup criada\nresource "azurerm_backup_protected_vm" "main" {\n  count               = var.enable_backup ? var.vm_count : 0\n  resource_group_name = azurerm_resource_group.main.name\n  recovery_vault_name = azurerm_recovery_services_vault.main[0].name\n  source_vm_id        = azurerm_linux_virtual_machine.main[count.index].id\n  backup_policy_id    = azurerm_backup_policy_vm.main[0].id\n}\n\n# Auto-shutdown das VMs - desliga automaticamente para economizar custos\n# Especialmente \xfatil em ambientes de desenvolvimento e teste\nresource "azurerm_dev_test_global_vm_shutdown_schedule" "main" {\n  count              = local.should_enable_auto_shutdown ? var.vm_count : 0\n  virtual_machine_id = azurerm_linux_virtual_machine.main[count.index].id\n  location           = azurerm_resource_group.main.location\n  enabled            = true\n\n  daily_recurrence_time = var.auto_shutdown_time\n  timezone              = var.auto_shutdown_timezone\n\n  # Configura\xe7\xf5es de notifica\xe7\xe3o antes do shutdown\n  notification_settings {\n    enabled         = var.notification_email != ""\n    time_in_minutes = 30\n    email           = var.notification_email != "" ? var.notification_email : "noreply@example.com"\n  }\n\n  tags = local.common_tags\n}\n\n# Application Security Group - agrupa VMs logicamente para regras de firewall\n# Facilita aplica\xe7\xe3o de regras de seguran\xe7a baseadas em fun\xe7\xe3o\nresource "azurerm_application_security_group" "web" {\n  name                = "${local.naming_prefix}-asg-web"\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n\n  tags = local.common_tags\n}\n\n# Associa as NICs das VMs ao Application Security Group\nresource "azurerm_network_interface_application_security_group_association" "web" {\n  count                         = var.vm_count\n  network_interface_id          = azurerm_network_interface.main[count.index].id\n  application_security_group_id = azurerm_application_security_group.web.id\n}\n\n# Action Group para alertas do Azure Monitor - define quem recebe alertas\nresource "azurerm_monitor_action_group" "main" {\n  count               = var.enable_monitoring ? 1 : 0\n  name                = "${local.naming_prefix}-actiongroup"\n  resource_group_name = azurerm_resource_group.main.name\n  short_name          = "webapp-ag"\n\n  # Destinat\xe1rio de email para alertas\n  email_receiver {\n    name          = "admin"\n    email_address = "admin@empresa.com.br"\n  }\n\n  tags = local.common_tags\n}\n\n# Alerta de CPU alta - monitora uso de CPU das VMs\n# Dispara alerta quando CPU passa de 80% por per\xedodo prolongado\nresource "azurerm_monitor_metric_alert" "cpu_high" {\n  count               = var.enable_monitoring ? var.vm_count : 0\n  name                = "${azurerm_linux_virtual_machine.main[count.index].name}-cpu-alert"\n  resource_group_name = azurerm_resource_group.main.name\n  scopes              = [azurerm_linux_virtual_machine.main[count.index].id]\n  description         = "Alert when CPU usage is over 80%"\n  severity            = 2\n\n  # Crit\xe9rio do alerta - CPU m\xe9dia maior que 80%\n  criteria {\n    metric_namespace = "Microsoft.Compute/virtualMachines"\n    metric_name      = "Percentage CPU"\n    aggregation      = "Average"\n    operator         = "GreaterThan"\n    threshold        = 80\n  }\n\n  # A\xe7\xe3o a tomar quando alerta \xe9 disparado\n  action {\n    action_group_id = azurerm_monitor_action_group.main[0].id\n  }\n\n  tags = local.common_tags\n}\n\n# Availability Set - garante alta disponibilidade para m\xfaltiplas VMs\n# Distribui VMs entre diferentes racks e dom\xednios de atualiza\xe7\xe3o\nresource "azurerm_availability_set" "main" {\n  count                        = var.vm_count > 1 ? 1 : 0\n  name                         = "${local.naming_prefix}-avset"\n  location                     = azurerm_resource_group.main.location\n  resource_group_name          = azurerm_resource_group.main.name\n  platform_fault_domain_count  = 2\n  platform_update_domain_count = 2\n  managed                      = true\n\n  tags = local.common_tags\n}\n\n# Private DNS Zone - resolu\xe7\xe3o de nomes interna para VMs\n# Permite usar nomes amig\xe1veis em vez de IPs para comunica\xe7\xe3o interna\nresource "azurerm_private_dns_zone" "main" {\n  name                = "${var.project_name}.local"\n  resource_group_name = azurerm_resource_group.main.name\n\n  tags = local.common_tags\n}\n\n# Link da Private DNS Zone com a VNet - habilita resolu\xe7\xe3o DNS autom\xe1tica\nresource "azurerm_private_dns_zone_virtual_network_link" "main" {\n  name                  = "${local.naming_prefix}-dns-link"\n  resource_group_name   = azurerm_resource_group.main.name\n  private_dns_zone_name = azurerm_private_dns_zone.main.name\n  virtual_network_id    = azurerm_virtual_network.main.id\n  registration_enabled  = true\n\n  tags = local.common_tags\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"variablestf",children:"variables.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# Vari\xe1vel para nome do projeto - ser\xe1 usada como prefixo em todos os recursos\n# Valida\xe7\xe3o garante apenas letras min\xfasculas e n\xfameros para compatibilidade com Azure\nvariable "project_name" {\n  description = "Nome do projeto que ser\xe1 usado como prefixo para recursos"\n  type        = string\n  default     = "webapp"\n  \n  validation {\n    condition     = can(regex("^[a-z0-9]+$", var.project_name))\n    error_message = "Project name deve conter apenas letras min\xfasculas e n\xfameros."\n  }\n}\n\n# Vari\xe1vel de ambiente - controla configura\xe7\xf5es espec\xedficas por ambiente\n# Aceita apenas valores predefinidos para evitar erros de configura\xe7\xe3o\nvariable "environment" {\n  description = "Environment (dev, staging, prod)"\n  type        = string\n  default     = "dev"\n  \n  validation {\n    condition     = contains(["dev", "staging", "prod"], var.environment)\n    error_message = "Environment deve ser: dev, staging, ou prod."\n  }\n}\n\n# Regi\xe3o Azure onde todos os recursos ser\xe3o criados\n# Lista pr\xe9-aprovada de regi\xf5es para controlar custos e compliance\nvariable "location" {\n  description = "Azure region onde os recursos ser\xe3o criados"\n  type        = string\n  default     = "Brazil South"\n  \n  validation {\n    condition = contains([\n      "Brazil South", "East US", "East US 2", "West US", "West US 2",\n      "Central US", "North Central US", "South Central US", "West Central US",\n      "Canada Central", "Canada East", "West Europe", "North Europe",\n      "UK South", "UK West", "France Central", "Germany West Central",\n      "Switzerland North", "Norway East", "Sweden Central"\n    ], var.location)\n    error_message = "Location deve ser uma regi\xe3o Azure v\xe1lida."\n  }\n}\n\n# N\xfamero de VMs a serem criadas - usado com count em m\xfaltiplos recursos\n# Limitado entre 1-5 para evitar custos excessivos em labs\nvariable "vm_count" {\n  description = "N\xfamero de VMs a serem criadas"\n  type        = number\n  default     = 1\n  \n  validation {\n    condition     = var.vm_count >= 1 && var.vm_count <= 5\n    error_message = "VM count deve estar entre 1 e 5."\n  }\n}\n\n# Tamanho (SKU) das VMs - define CPU, RAM e performance\n# Lista restrita de tamanhos aprovados para controlar custos\nvariable "vm_size" {\n  description = "Tamanho da VM"\n  type        = string\n  default     = "Standard_B2s"\n  \n  validation {\n    condition = contains([\n      "Standard_B1s", "Standard_B1ms", "Standard_B2s", "Standard_B2ms",\n      "Standard_B4ms", "Standard_D2s_v3", "Standard_D4s_v3",\n      "Standard_F2s_v2", "Standard_F4s_v2"\n    ], var.vm_size)\n    error_message = "VM size deve ser um dos tamanhos aprovados."\n  }\n}\n\n# Nome do usu\xe1rio administrativo das VMs\n# Valida\xe7\xe3o garante formato correto (3-20 caracteres, inicia com letra)\nvariable "admin_username" {\n  description = "Nome de usu\xe1rio administrativo para as VMs"\n  type        = string\n  default     = "azureuser"\n  \n  validation {\n    condition     = can(regex("^[a-z][a-z0-9]{2,19}$", var.admin_username))\n    error_message = "Admin username deve come\xe7ar com letra min\xfascula e ter entre 3-20 caracteres."\n  }\n}\n\n# Tipo de disco para o sistema operacional - afeta performance e custo\n# Op\xe7\xf5es: Standard (HDD), StandardSSD, Premium (SSD)\nvariable "os_disk_type" {\n  description = "Tipo do disco do OS"\n  type        = string\n  default     = "Premium_LRS"\n  \n  validation {\n    condition = contains([\n      "Standard_LRS", "StandardSSD_LRS", "Premium_LRS"\n    ], var.os_disk_type)\n    error_message = "OS disk type deve ser: Standard_LRS, StandardSSD_LRS, ou Premium_LRS."\n  }\n}\n\n# Tamanho do disco de dados adicional em GB\n# Separado do disco do OS para melhor organiza\xe7\xe3o e performance\nvariable "data_disk_size_gb" {\n  description = "Tamanho do disco de dados em GB"\n  type        = number\n  default     = 64\n  \n  validation {\n    condition     = var.data_disk_size_gb >= 32 && var.data_disk_size_gb <= 1024\n    error_message = "Data disk size deve estar entre 32GB e 1024GB."\n  }\n}\n\n# CIDR da Virtual Network - define range de IPs da rede privada\n# Deve ser RFC 1918 (10.x, 172.16-31.x, 192.168.x)\nvariable "vnet_address_space" {\n  description = "Address space para a VNet"\n  type        = string\n  default     = "10.0.0.0/16"\n  \n  validation {\n    condition     = can(cidrhost(var.vnet_address_space, 0))\n    error_message = "VNet address space deve ser um CIDR v\xe1lido."\n  }\n}\n\n# CIDR da subnet para servidores web\n# Deve estar contido dentro do address_space da VNet\nvariable "web_subnet_address_prefix" {\n  description = "Address prefix para a subnet web"\n  type        = string\n  default     = "10.0.1.0/24"\n  \n  validation {\n    condition     = can(cidrhost(var.web_subnet_address_prefix, 0))\n    error_message = "Web subnet address prefix deve ser um CIDR v\xe1lido."\n  }\n}\n\n# CIDR da subnet para banco de dados\n# Isolamento de rede para maior seguran\xe7a dos dados\nvariable "db_subnet_address_prefix" {\n  description = "Address prefix para a subnet de banco de dados"\n  type        = string\n  default     = "10.0.2.0/24"\n  \n  validation {\n    condition     = can(cidrhost(var.db_subnet_address_prefix, 0))\n    error_message = "DB subnet address prefix deve ser um CIDR v\xe1lido."\n  }\n}\n\n# Range de IPs permitidos para acesso SSH\n# Pode ser CIDR espec\xedfico ou "*" para qualquer IP (n\xe3o recomendado para prod)\nvariable "ssh_source_address_prefix" {\n  description = "Source address prefix permitido para SSH"\n  type        = string\n  default     = "*"\n  \n  validation {\n    condition = can(cidrhost(var.ssh_source_address_prefix, 0)) || var.ssh_source_address_prefix == "*"\n    error_message = "SSH source address prefix deve ser um CIDR v\xe1lido ou \'*\'."\n  }\n}\n\n# Objeto complexo que define qual imagem de VM usar\n# Especifica publisher, offer, sku e version da imagem do Azure Marketplace\nvariable "vm_image" {\n  description = "Imagem da VM"\n  type = object({\n    publisher = string\n    offer     = string\n    sku       = string\n    version   = string\n  })\n  default = {\n    publisher = "Canonical"\n    offer     = "0001-com-ubuntu-server-focal"\n    sku       = "20_04-lts-gen2"\n    version   = "latest"\n  }\n}\n\n# Tags personalizadas para recursos - importante para billing e governan\xe7a\n# Valida\xe7\xe3o garante formato correto das chaves das tags\nvariable "tags" {\n  description = "Tags adicionais para aplicar aos recursos"\n  type        = map(string)\n  default     = {}\n  \n  validation {\n    condition     = alltrue([for k, v in var.tags : can(regex("^[a-zA-Z0-9_.-]+$", k))])\n    error_message = "Tag keys devem conter apenas letras, n\xfameros, h\xedfens, underscores e pontos."\n  }\n}\n\n# Flag para habilitar backup das VMs - recursos condicionais\n# Controla cria\xe7\xe3o do Recovery Services Vault e pol\xedticas de backup\nvariable "enable_backup" {\n  description = "Habilitar backup das VMs"\n  type        = bool\n  default     = false\n}\n\n# Per\xedodo de reten\xe7\xe3o dos backups em dias\n# Afeta custos de armazenamento - maior reten\xe7\xe3o = maior custo\nvariable "backup_retention_days" {\n  description = "N\xfamero de dias para reten\xe7\xe3o de backup"\n  type        = number\n  default     = 30\n  \n  validation {\n    condition     = var.backup_retention_days >= 7 && var.backup_retention_days <= 365\n    error_message = "Backup retention deve estar entre 7 e 365 dias."\n  }\n}\n\n# Flag para habilitar monitoring com Log Analytics\n# Controla cria\xe7\xe3o do workspace e instala\xe7\xe3o de agentes\nvariable "enable_monitoring" {\n  description = "Habilitar monitoring com Log Analytics"\n  type        = bool\n  default     = true\n}\n\n# Hor\xe1rio para auto-shutdown das VMs em formato 24h (HHMM)\n# Crucial para economizar custos em ambientes de desenvolvimento\nvariable "auto_shutdown_time" {\n  description = "Hor\xe1rio para auto shutdown das VMs (formato 24h: HHMM)"\n  type        = string\n  default     = "1800"\n  \n  validation {\n    condition     = can(regex("^([01]?[0-9]|2[0-3])[0-5][0-9]$", var.auto_shutdown_time))\n    error_message = "Auto shutdown time deve estar no formato HHMM (ex: 1800 para 18:00)."\n  }\n}\n\n# Timezone para o auto-shutdown - importante para hor\xe1rio correto\nvariable "auto_shutdown_timezone" {\n  description = "Timezone para auto shutdown"\n  type        = string\n  default     = "E. South America Standard Time"\n}\n\n# Email para receber notifica\xe7\xf5es de auto-shutdown (opcional)\n# Se vazio, notifica\xe7\xf5es s\xe3o desabilitadas\nvariable "notification_email" {\n  description = "Email para receber notifica\xe7\xf5es de auto-shutdown (opcional)"\n  type        = string\n  default     = ""\n  \n  validation {\n    condition = var.notification_email == "" || can(regex("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}$", var.notification_email))\n    error_message = "Notification email deve ser um email v\xe1lido ou string vazia."\n  }\n}\n\n# Lista de CIDRs permitidos para SSH - alternativa mais granular ao ssh_source_address_prefix\n# Permite m\xfaltiplos ranges (ex: rede corporativa + VPN)\nvariable "allowed_ssh_cidrs" {\n  description = "Lista de CIDRs permitidos para acesso SSH"\n  type        = list(string)\n  default     = ["0.0.0.0/0"]\n  \n  validation {\n    condition = alltrue([\n      for cidr in var.allowed_ssh_cidrs : can(cidrhost(cidr, 0))\n    ])\n    error_message = "Todos os CIDRs devem ser v\xe1lidos."\n  }\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"localstf",children:"locals.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'locals {\n  # Prefixo padr\xe3o para nomenclatura de recursos\n  # Combina nome do projeto + ambiente (ex: webapp-dev)\n  naming_prefix = "${var.project_name}-${var.environment}"\n  \n  # Nomes padronizados de recursos seguindo conven\xe7\xe3o {projeto}-{ambiente}-{tipo}\n  # Centralizado para facilitar mudan\xe7as e manter consist\xeancia\n  resource_group_name    = "${local.naming_prefix}-rg"\n  vnet_name             = "${local.naming_prefix}-vnet"\n  web_subnet_name       = "${local.naming_prefix}-subnet-web"\n  db_subnet_name        = "${local.naming_prefix}-subnet-db"\n  web_nsg_name          = "${local.naming_prefix}-nsg-web"\n  db_nsg_name           = "${local.naming_prefix}-nsg-db"\n  public_ip_name        = "${local.naming_prefix}-pip"\n  nic_name              = "${local.naming_prefix}-nic"\n  vm_name               = "${local.naming_prefix}-vm"\n  lb_name               = "${local.naming_prefix}-lb"\n  key_vault_name        = "${local.naming_prefix}-kv-${random_id.storage_suffix.hex}"\n  log_analytics_name    = "${local.naming_prefix}-law"\n  \n  # Nome da storage account sem h\xedfens (limita\xe7\xe3o do Azure)\n  # Combina projeto + ambiente + sufixo aleat\xf3rio para uniqueness global\n  storage_account_prefix = replace("${var.project_name}${var.environment}diag", "-", "")\n  \n  # Prefixo DNS para Public IPs - deve ser globalmente \xfanico\n  # Inclui sufixo aleat\xf3rio para evitar conflitos\n  dns_prefix = "${var.project_name}${var.environment}${random_id.storage_suffix.hex}"\n  \n  # Tags comuns aplicadas a todos os recursos\n  # Merge combina tags padr\xe3o com tags personalizadas do usu\xe1rio\n  common_tags = merge({\n    Project     = var.project_name\n    Environment = var.environment\n    ManagedBy   = "Terraform"\n    CreatedBy   = "TerraformProject"\n    CreatedOn   = formatdate("YYYY-MM-DD", timestamp())\n    Owner       = "DevOps Team"\n    CostCenter  = "IT-Infrastructure"\n    Backup      = var.enable_backup ? "Enabled" : "Disabled"\n    Monitoring  = var.enable_monitoring ? "Enabled" : "Disabled"\n  }, var.tags)\n  \n  # Configura\xe7\xe3o de rede centralizada\n  # Facilita refer\xeancia e poss\xedveis mudan\xe7as futuras\n  network_config = {\n    vnet_address_space         = var.vnet_address_space\n    web_subnet_address_prefix  = var.web_subnet_address_prefix\n    db_subnet_address_prefix   = var.db_subnet_address_prefix\n    dns_servers               = ["168.63.129.16"] # Azure DNS padr\xe3o\n  }\n  \n  # Configura\xe7\xf5es espec\xedficas por ambiente para otimiza\xe7\xe3o de custos\n  # Define tamanhos e features apropriados para cada ambiente\n  vm_config = {\n    dev = {\n      size                = "Standard_B1s"      # VM pequena para dev\n      os_disk_type       = "Standard_LRS"      # Disco mais barato\n      data_disk_size_gb  = 32                  # Disco menor\n      enable_backup      = false               # Sem backup para economizar\n      auto_shutdown      = true                # Auto-shutdown habilitado\n    }\n    staging = {\n      size                = "Standard_B2s"      # VM m\xe9dia para staging\n      os_disk_type       = "StandardSSD_LRS"   # SSD padr\xe3o\n      data_disk_size_gb  = 64                  # Disco m\xe9dio\n      enable_backup      = true                # Backup habilitado\n      auto_shutdown      = true                # Auto-shutdown habilitado\n    }\n    prod = {\n      size                = "Standard_D2s_v3"   # VM robusta para prod\n      os_disk_type       = "Premium_LRS"       # SSD premium\n      data_disk_size_gb  = 128                 # Disco maior\n      enable_backup      = true                # Backup obrigat\xf3rio\n      auto_shutdown      = false               # Sem auto-shutdown\n    }\n  }\n  \n  # Valores efetivos baseados no ambiente atual\n  # Se vari\xe1vel n\xe3o foi alterada, usa configura\xe7\xe3o do ambiente\n  effective_vm_size = var.vm_size != "Standard_B2s" ? var.vm_size : local.vm_config[var.environment].size\n  effective_os_disk_type = var.os_disk_type != "Premium_LRS" ? var.os_disk_type : local.vm_config[var.environment].os_disk_type\n  effective_data_disk_size = var.data_disk_size_gb != 64 ? var.data_disk_size_gb : local.vm_config[var.environment].data_disk_size_gb\n  \n  # Regras de seguran\xe7a para tr\xe1fego web (HTTP/HTTPS)\n  # Array de objetos que define regras padr\xe3o para servidores web\n  web_security_rules = [\n    {\n      name                       = "HTTP"\n      priority                   = 1001\n      direction                  = "Inbound"\n      access                     = "Allow"\n      protocol                   = "Tcp"\n      source_port_range          = "*"\n      destination_port_range     = "80"\n      source_address_prefix      = "*"\n      destination_address_prefix = "*"\n    },\n    {\n      name                       = "HTTPS"\n      priority                   = 1002\n      direction                  = "Inbound"\n      access                     = "Allow"\n      protocol                   = "Tcp"\n      source_port_range          = "*"\n      destination_port_range     = "443"\n      source_address_prefix      = "*"\n      destination_address_prefix = "*"\n    }\n  ]\n  \n  # Regras de SSH din\xe2micas - uma para cada CIDR permitido\n  # For expression cria regras com prioridades incrementais\n  ssh_security_rules = [\n    for i, cidr in var.allowed_ssh_cidrs : {\n      name                       = "SSH-${i + 1}"\n      priority                   = 1100 + i        # Prioridades: 1100, 1101, 1102...\n      direction                  = "Inbound"\n      access                     = "Allow"\n      protocol                   = "Tcp"\n      source_port_range          = "*"\n      destination_port_range     = "22"\n      source_address_prefix      = cidr\n      destination_address_prefix = "*"\n    }\n  ]\n  \n  # Todas as regras de seguran\xe7a combinadas\n  # Concat junta arrays de regras web + SSH\n  all_security_rules = concat(local.web_security_rules, local.ssh_security_rules)\n  \n  # Configura\xe7\xe3o de backup condicional\n  # S\xf3 define configura\xe7\xe3o se backup estiver habilitado\n  backup_config = var.enable_backup ? {\n    policy_name           = "${local.naming_prefix}-backup-policy"\n    vault_name           = "${local.naming_prefix}-rsv"\n    retention_daily      = var.backup_retention_days\n    retention_weekly     = 4\n    retention_monthly    = 12\n    retention_yearly     = 1\n    backup_time         = "23:00"\n    backup_timezone     = var.auto_shutdown_timezone\n  } : null\n  \n  # Configura\xe7\xe3o de monitoring condicional\n  # Define par\xe2metros do Log Analytics se monitoring habilitado\n  monitoring_config = var.enable_monitoring ? {\n    workspace_name       = local.log_analytics_name\n    retention_days      = 30\n    sku                 = "PerGB2018"\n    solutions = [\n      "VMInsights",    # Insights de VMs\n      "Security",      # Security Center\n      "Updates"        # Update Management\n    ]\n  } : null\n  \n  # Configura\xe7\xe3o de auto-shutdown\n  # Combina configura\xe7\xe3o do ambiente com vari\xe1veis do usu\xe1rio\n  auto_shutdown_config = {\n    enabled          = local.vm_config[var.environment].auto_shutdown\n    time            = var.auto_shutdown_time\n    timezone        = var.auto_shutdown_timezone\n    notification_settings = {\n      enabled         = true\n      time_in_minutes = 30                # Notifica 30min antes\n      webhook_url     = ""\n      email_recipient = ""\n    }\n  }\n  \n  # Flags condicionais para cria\xe7\xe3o de recursos\n  # Determinam quais recursos opcionais criar baseado em l\xf3gica\n  should_create_load_balancer = var.vm_count > 1                                      # LB s\xf3 com m\xfaltiplas VMs\n  should_create_backup = var.enable_backup && local.vm_config[var.environment].enable_backup  # Backup habilitado + config do ambiente\n  should_create_monitoring = var.enable_monitoring                                     # Monitoring se habilitado\n  should_enable_auto_shutdown = local.auto_shutdown_config.enabled                    # Auto-shutdown baseado no ambiente\n  \n  # Mapeamento de regi\xf5es Azure para c\xf3digos curtos\n  # Usado para nomenclatura quando regi\xe3o faz parte do nome\n  location_short = {\n    "Brazil South"              = "brs"\n    "East US"                   = "eus"\n    "East US 2"                 = "eus2" \n    "West US"                   = "wus"\n    "West US 2"                 = "wus2"\n    "Central US"                = "cus"\n    "North Central US"          = "ncus"\n    "South Central US"          = "scus"\n    "West Central US"           = "wcus"\n    "Canada Central"            = "cac"\n    "Canada East"               = "cae"\n    "West Europe"               = "weu"\n    "North Europe"              = "neu"\n    "UK South"                  = "uks"\n    "UK West"                   = "ukw"\n    "France Central"            = "frc"\n    "Germany West Central"      = "gwc"\n    "Switzerland North"         = "swn"\n    "Norway East"               = "noe"\n    "Sweden Central"            = "sec"\n  }\n  \n  # Sufixo da localiza\xe7\xe3o para nomenclatura\n  location_suffix = lookup(local.location_short, var.location, "unknown")\n  \n  # Nomenclatura avan\xe7ada incluindo localiza\xe7\xe3o\n  # Para recursos que precisam indicar regi\xe3o no nome\n  advanced_naming = {\n    resource_group    = "${local.naming_prefix}-${local.location_suffix}-rg"\n    storage_account   = lower(replace("${var.project_name}${var.environment}${local.location_suffix}sa${random_id.storage_suffix.hex}", "-", ""))\n    key_vault        = "${local.naming_prefix}-${local.location_suffix}-kv"\n  }\n  \n  # Configura\xe7\xe3o de Network ACLs para storage accounts\n  # Produ\xe7\xe3o nega acesso por padr\xe3o, outros ambientes permitem tudo\n  network_acls = {\n    default_action = "Deny"\n    ip_rules = var.environment == "prod" ? [] : ["0.0.0.0/0"]  # Prod sem IPs permitidos\n    virtual_network_subnet_ids = [\n      # Ser\xe1 preenchido ap\xf3s cria\xe7\xe3o das subnets se necess\xe1rio\n    ]\n  }\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"outputstf",children:"outputs.tf"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# Informa\xe7\xf5es b\xe1sicas do Resource Group\n# Nome do container l\xf3gico que agrupa todos os recursos\noutput "resource_group_name" {\n  description = "Nome do Resource Group criado"\n  value       = azurerm_resource_group.main.name\n}\n\n# Localiza\xe7\xe3o onde os recursos foram criados\noutput "resource_group_location" {\n  description = "Localiza\xe7\xe3o do Resource Group"\n  value       = azurerm_resource_group.main.location\n}\n\n# ID \xfanico do Resource Group no Azure\noutput "resource_group_id" {\n  description = "ID do Resource Group"\n  value       = azurerm_resource_group.main.id\n}\n\n# Informa\xe7\xf5es da rede virtual criada\n# Nome da VNet para refer\xeancia em outros scripts\noutput "virtual_network_name" {\n  description = "Nome da Virtual Network"\n  value       = azurerm_virtual_network.main.name\n}\n\n# ID da VNet para uso em associa\xe7\xf5es e pol\xedticas\noutput "virtual_network_id" {\n  description = "ID da Virtual Network"\n  value       = azurerm_virtual_network.main.id\n}\n\n# Espa\xe7o de endere\xe7os da VNet para documenta\xe7\xe3o e troubleshooting\noutput "virtual_network_address_space" {\n  description = "Address space da Virtual Network"\n  value       = azurerm_virtual_network.main.address_space\n}\n\n# IDs das subnets para conex\xe3o de recursos futuros\noutput "web_subnet_id" {\n  description = "ID da subnet web"\n  value       = azurerm_subnet.web.id\n}\n\noutput "database_subnet_id" {\n  description = "ID da subnet database"\n  value       = azurerm_subnet.database.id\n}\n\n# Informa\xe7\xf5es das VMs criadas\n# Lista com nomes de todas as VMs para administra\xe7\xe3o\noutput "vm_names" {\n  description = "Nomes das VMs criadas"\n  value       = azurerm_linux_virtual_machine.main[*].name\n}\n\n# IDs das VMs para uso em scripts de automa\xe7\xe3o\noutput "vm_ids" {\n  description = "IDs das VMs criadas"\n  value       = azurerm_linux_virtual_machine.main[*].id\n}\n\n# IPs privados das VMs para comunica\xe7\xe3o interna\n# For expression extrai IP de cada network interface\noutput "vm_private_ip_addresses" {\n  description = "Endere\xe7os IP privados das VMs"\n  value = [\n    for nic in azurerm_network_interface.main :\n    nic.ip_configuration[0].private_ip_address\n  ]\n}\n\n# IPs p\xfablicos das VMs para acesso externo\n# Lista de IPs para conex\xe3o SSH e acesso web\noutput "vm_public_ip_addresses" {\n  description = "Endere\xe7os IP p\xfablicos das VMs"\n  value = [\n    for pip in azurerm_public_ip.main :\n    pip.ip_address\n  ]\n}\n\n# FQDNs (nomes DNS completos) das VMs\n# URLs amig\xe1veis para acesso \xe0s VMs\noutput "vm_fqdns" {\n  description = "FQDNs das VMs"\n  value = [\n    for pip in azurerm_public_ip.main :\n    pip.fqdn\n  ]\n}\n\n# Informa\xe7\xf5es do Load Balancer (quando aplic\xe1vel)\n# IP p\xfablico do LB se m\xfaltiplas VMs foram criadas\noutput "load_balancer_public_ip" {\n  description = "IP p\xfablico do Load Balancer"\n  value       = var.vm_count > 1 ? azurerm_public_ip.lb[0].ip_address : null\n}\n\n# FQDN do Load Balancer para acesso web balanceado\noutput "load_balancer_fqdn" {\n  description = "FQDN do Load Balancer"\n  value       = var.vm_count > 1 ? azurerm_public_ip.lb[0].fqdn : null\n}\n\n# Chave SSH privada para acesso \xe0s VMs\n# Marcada como sensitive para n\xe3o aparecer em logs\noutput "ssh_private_key_pem" {\n  description = "Chave SSH privada em formato PEM"\n  value       = tls_private_key.ssh.private_key_pem\n  sensitive   = true\n}\n\n# Chave SSH p\xfablica para refer\xeancia e backup\noutput "ssh_public_key" {\n  description = "Chave SSH p\xfablica"\n  value       = tls_private_key.ssh.public_key_openssh\n}\n\n# Informa\xe7\xf5es da Storage Account para boot diagnostics\noutput "boot_diagnostics_storage_account_name" {\n  description = "Nome da Storage Account para boot diagnostics"\n  value       = azurerm_storage_account.boot_diagnostics.name\n}\n\n# Endpoint da storage account para configura\xe7\xf5es adicionais\noutput "boot_diagnostics_storage_account_primary_endpoint" {\n  description = "Endpoint prim\xe1rio da Storage Account"\n  value       = azurerm_storage_account.boot_diagnostics.primary_blob_endpoint\n}\n\n# Informa\xe7\xf5es do Key Vault para acesso a secrets\noutput "key_vault_name" {\n  description = "Nome do Key Vault"\n  value       = azurerm_key_vault.main.name\n}\n\n# URI do Key Vault para integra\xe7\xe3o com aplica\xe7\xf5es\noutput "key_vault_uri" {\n  description = "URI do Key Vault"\n  value       = azurerm_key_vault.main.vault_uri\n}\n\n# Informa\xe7\xf5es dos discos de dados adicionais\noutput "data_disk_names" {\n  description = "Nomes dos discos de dados"\n  value       = azurerm_managed_disk.data[*].name\n}\n\n# Tamanhos dos discos para planejamento de capacidade\noutput "data_disk_sizes" {\n  description = "Tamanhos dos discos de dados em GB"\n  value       = azurerm_managed_disk.data[*].disk_size_gb\n}\n\n# Informa\xe7\xf5es do Network Security Group\noutput "web_nsg_id" {\n  description = "ID do Network Security Group web"\n  value       = azurerm_network_security_group.web.id\n}\n\n# Regras de seguran\xe7a aplicadas para auditoria\n# For expression formata regras de forma leg\xedvel\noutput "web_nsg_security_rules" {\n  description = "Regras de seguran\xe7a do NSG web"\n  value = [\n    for rule in azurerm_network_security_group.web.security_rule :\n    {\n      name                   = rule.name\n      priority               = rule.priority\n      direction              = rule.direction\n      access                 = rule.access\n      protocol               = rule.protocol\n      destination_port_range = rule.destination_port_range\n    }\n  ]\n}\n\n# Resumo completo do deployment para documenta\xe7\xe3o\n# Objeto com todas as informa\xe7\xf5es principais\noutput "deployment_summary" {\n  description = "Resumo do deployment"\n  value = {\n    project_name          = var.project_name\n    environment           = var.environment\n    location              = var.location\n    vm_count              = var.vm_count\n    vm_size               = local.effective_vm_size\n    resource_group        = azurerm_resource_group.main.name\n    virtual_network       = azurerm_virtual_network.main.name\n    load_balancer_enabled = var.vm_count > 1\n    backup_enabled        = var.enable_backup\n    monitoring_enabled    = var.enable_monitoring\n    total_data_disk_gb    = sum(azurerm_managed_disk.data[*].disk_size_gb)\n    creation_date         = formatdate("YYYY-MM-DD hh:mm:ss ZZZ", timestamp())\n  }\n}\n\n# Informa\xe7\xf5es para estimativa de custos\n# Dados estruturados para c\xe1lculos de billing\noutput "cost_estimation_info" {\n  description = "Informa\xe7\xf5es para estimativa de custos"\n  value = {\n    region = var.location\n    vms = [\n      for i in range(var.vm_count) : {\n        name           = azurerm_linux_virtual_machine.main[i].name\n        size           = azurerm_linux_virtual_machine.main[i].size\n        os_disk_type   = azurerm_linux_virtual_machine.main[i].os_disk[0].storage_account_type\n        data_disk_type = azurerm_managed_disk.data[i].storage_account_type\n        data_disk_size = azurerm_managed_disk.data[i].disk_size_gb\n      }\n    ]\n    storage_accounts = [\n      {\n        name         = azurerm_storage_account.boot_diagnostics.name\n        account_tier = azurerm_storage_account.boot_diagnostics.account_tier\n        replication  = azurerm_storage_account.boot_diagnostics.account_replication_type\n      }\n    ]\n    public_ips    = length(azurerm_public_ip.main) + (var.vm_count > 1 ? 1 : 0)\n    load_balancer = var.vm_count > 1\n  }\n}\n\n# Informa\xe7\xf5es de conex\xe3o SSH prontas para uso\n# Comandos formatados para conex\xe3o imediata\noutput "connection_info" {\n  description = "Informa\xe7\xf5es de conex\xe3o SSH"\n  value = {\n    username = var.admin_username\n    ssh_command = var.vm_count == 1 ? [\n      "ssh -i private_key.pem ${var.admin_username}@${azurerm_public_ip.main[0].ip_address}"\n      ] : [\n      for i, pip in azurerm_public_ip.main :\n      "ssh -i private_key.pem ${var.admin_username}@${pip.ip_address} # VM ${i + 1}"\n    ]\n  }\n}\n\n# Informa\xe7\xf5es de DNS para acesso amig\xe1vel\noutput "dns_information" {\n  description = "Informa\xe7\xf5es de DNS"\n  value = {\n    public_dns_names = [\n      for pip in azurerm_public_ip.main :\n      pip.fqdn if pip.fqdn != null\n    ]\n    load_balancer_dns = var.vm_count > 1 ? azurerm_public_ip.lb[0].fqdn : null\n  }\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"terraformtfvars",children:"terraform.tfvars"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# terraform.tfvars - Configura\xe7\xe3o principal do projeto\n# Este arquivo cont\xe9m os valores padr\xe3o para todas as vari\xe1veis\n\n# === CONFIGURA\xc7\xc3O B\xc1SICA DO PROJETO ===\n# Nome do projeto usado como prefixo em todos os recursos\nproject_name = "webapp"\n\n# Ambiente de deployment - controla configura\xe7\xf5es espec\xedficas\nenvironment  = "dev"\n\n# Regi\xe3o Azure onde criar todos os recursos - impacta lat\xeancia e custos\nlocation     = "Brazil South"\n\n# === CONFIGURA\xc7\xc3O DAS VIRTUAL MACHINES ===\n# N\xfamero de VMs a criar - usando 2 para demonstrar load balancer\nvm_count          = 2\n\n# Tamanho da VM - Standard_B2s \xe9 boa op\xe7\xe3o custo-benef\xedcio para testes\nvm_size           = "Standard_B2s"\n\n# Nome do usu\xe1rio administrativo das VMs\nadmin_username    = "azureuser"\n\n# Tipo do disco do sistema operacional - Premium para melhor performance\nos_disk_type      = "Premium_LRS"\n\n# Tamanho do disco de dados adicional em GB\ndata_disk_size_gb = 64\n\n# === CONFIGURA\xc7\xc3O DE REDE ===\n# CIDR da Virtual Network - range privado para toda a infraestrutura\nvnet_address_space        = "10.0.0.0/16"\n\n# Subnet para servidores web - onde ficam as VMs\nweb_subnet_address_prefix = "10.0.1.0/24"\n\n# Subnet para banco de dados - isolamento de rede\ndb_subnet_address_prefix  = "10.0.2.0/24"\n\n# Range de IPs permitidos para SSH - "*" permite qualquer IP (cuidado em prod!)\nssh_source_address_prefix = "*"\n\n# Lista de CIDRs permitidos para SSH - alternativa mais granular\nallowed_ssh_cidrs = [\n  "0.0.0.0/0" # Substitua pelo seu IP ou range corporativo para maior seguran\xe7a\n  # Exemplos de uso em produ\xe7\xe3o:\n  # "201.123.45.0/24",  # Range corporativo\n  # "10.0.0.0/8"        # Rede interna VPN\n]\n\n# === CONFIGURA\xc7\xc3O DA IMAGEM DA VM ===\n# Imagem Ubuntu 20.04 LTS - est\xe1vel e amplamente suportada\nvm_image = {\n  publisher = "Canonical"\n  offer     = "0001-com-ubuntu-server-focal"\n  sku       = "20_04-lts-gen2"\n  version   = "latest"\n}\n\n# === CONFIGURA\xc7\xd5ES OPCIONAIS ===\n# Habilitar backup das VMs - importante para dados cr\xedticos\nenable_backup         = true\n\n# Per\xedodo de reten\xe7\xe3o dos backups em dias\nbackup_retention_days = 30\n\n# Habilitar monitoring com Log Analytics - recomendado para observabilidade\nenable_monitoring     = true\n\n# === CONFIGURA\xc7\xc3O DE AUTO-SHUTDOWN ===\n# Hor\xe1rio para desligar VMs automaticamente (formato 24h)\nauto_shutdown_time     = "1900" # 19:00 - economiza custos em ambiente de desenvolvimento\n\n# Timezone para o auto-shutdown\nauto_shutdown_timezone = "E. South America Standard Time"\n\n# Email para receber notifica\xe7\xf5es de shutdown (opcional)\n# Deixe vazio ("") se n\xe3o quiser receber notifica\xe7\xf5es\nnotification_email = "" # Exemplo: "admin@empresa.com"\n\n# === TAGS PERSONALIZADAS ===\n# Tags aplicadas a todos os recursos para organiza\xe7\xe3o e billing\ntags = {\n  Owner      = "DevOps Team"           # Respons\xe1vel pelos recursos\n  CostCenter = "TI-Infraestrutura"    # Centro de custo para billing\n  Project    = "Projeto Final Terraform"  # Nome do projeto\n  Course     = "Udemy Terraform"      # Refer\xeancia ao curso\n  Student    = "Seu Nome Aqui"        # Personalize com seu nome\n  Purpose    = "Learning"             # Prop\xf3sito dos recursos\n  Department = "Engineering"          # Departamento respons\xe1vel\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"devtfvars",children:"dev.tfvars"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# dev.tfvars - Configura\xe7\xe3o espec\xedfica para ambiente de desenvolvimento\n# Otimizada para custos baixos e flexibilidade\n\n# === IDENTIFICA\xc7\xc3O DO AMBIENTE ===\nproject_name = "webapp"\nenvironment  = "dev"      # Ambiente de desenvolvimento\nlocation     = "Brazil South"\n\n# === CONFIGURA\xc7\xc3O ECON\xd4MICA PARA DEV ===\n# Uma VM pequena \xe9 suficiente para desenvolvimento\nvm_count          = 1\nvm_size           = "Standard_B1s"    # VM mais barata dispon\xedvel\nadmin_username    = "azureuser"\n\n# Discos mais baratos para desenvolvimento\nos_disk_type      = "Standard_LRS"    # HDD padr\xe3o (mais barato)\ndata_disk_size_gb = 32               # Disco menor para economizar\n\n# === REDE SIMPLIFICADA ===\n# Range de rede separado para desenvolvimento\nvnet_address_space        = "10.10.0.0/16"\nweb_subnet_address_prefix = "10.10.1.0/24"\ndb_subnet_address_prefix  = "10.10.2.0/24"\n\n# === SEGURAN\xc7A RELAXADA PARA DEV ===\n# Em desenvolvimento, permitimos acesso de qualquer IP para facilitar testes\nssh_source_address_prefix = "*"\nallowed_ssh_cidrs         = ["0.0.0.0/0"]\n\n# === IMAGEM PADR\xc3O ===\n# Ubuntu LTS para consist\xeancia entre ambientes\nvm_image = {\n  publisher = "Canonical"\n  offer     = "0001-com-ubuntu-server-focal"\n  sku       = "20_04-lts-gen2"\n  version   = "latest"\n}\n\n# === FEATURES DESABILITADAS PARA ECONOMIA ===\n# Em desenvolvimento, desabilitamos features caras\nenable_backup     = false    # N\xe3o fazemos backup em dev para economizar\nenable_monitoring = false    # Monitoring desabilitado para reduzir custos\n\n# === AUTO-SHUTDOWN AGRESSIVO ===\n# Desliga VMs cedo para m\xe1xima economia\nauto_shutdown_time     = "1800" # 18:00 - mais cedo que outros ambientes\nauto_shutdown_timezone = "E. South America Standard Time"\n\n# Notifica\xe7\xf5es desabilitadas em dev\nnotification_email = ""\n\n# === TAGS DE DESENVOLVIMENTO ===\n# Tags espec\xedficas para ambiente de desenvolvimento\ntags = {\n  Owner       = "Developer"        # Desenvolvedor respons\xe1vel\n  CostCenter  = "R&D"             # Centro de pesquisa e desenvolvimento\n  Environment = "Development"      # Identifica\xe7\xe3o clara do ambiente\n  AutoDelete  = "true"            # Indica que pode ser deletado automaticamente\n  Purpose     = "Learning"        # Prop\xf3sito educacional\n  Course      = "Terraform Udemy" # Refer\xeancia ao curso\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"prodtfvars",children:"prod.tfvars"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-hcl",children:'# prod.tfvars - Configura\xe7\xe3o espec\xedfica para ambiente de produ\xe7\xe3o\n# Otimizada para performance, disponibilidade e seguran\xe7a\n\n# === IDENTIFICA\xc7\xc3O DO AMBIENTE ===\nproject_name = "webapp"\nenvironment  = "prod"     # Ambiente de produ\xe7\xe3o\nlocation     = "Brazil South"\n\n# === CONFIGURA\xc7\xc3O ROBUSTA PARA PRODU\xc7\xc3O ===\n# M\xfaltiplas VMs para alta disponibilidade\nvm_count          = 3\nvm_size           = "Standard_D2s_v3"    # VM com boa performance (2 vCPUs, 8GB RAM)\nadmin_username    = "prodadmin"          # Nome espec\xedfico para produ\xe7\xe3o\n\n# Discos premium para m\xe1xima performance\nos_disk_type      = "Premium_LRS"        # SSD premium\ndata_disk_size_gb = 128                  # Disco maior para dados de produ\xe7\xe3o\n\n# === REDE SEGMENTADA ===\n# Range de rede padr\xe3o para produ\xe7\xe3o\nvnet_address_space        = "10.0.0.0/16"\nweb_subnet_address_prefix = "10.0.1.0/24"\ndb_subnet_address_prefix  = "10.0.2.0/24"\n\n# === SEGURAN\xc7A RESTRITA ===\n# IMPORTANTE: Substitua pelos IPs reais da sua organiza\xe7\xe3o\nssh_source_address_prefix = "203.0.113.0/24" # Exemplo de range corporativo\n\n# Lista de ranges permitidos para SSH em produ\xe7\xe3o\nallowed_ssh_cidrs = [\n  "203.0.113.0/24",    # Range corporativo principal\n  "198.51.100.0/24"    # Range da VPN corporativa\n  # Adicione outros ranges conforme necess\xe1rio\n  # Nunca use "0.0.0.0/0" em produ\xe7\xe3o!\n]\n\n# === IMAGEM PADR\xc3O ===\n# Ubuntu LTS para estabilidade em produ\xe7\xe3o\nvm_image = {\n  publisher = "Canonical"\n  offer     = "0001-com-ubuntu-server-focal"\n  sku       = "20_04-lts-gen2"\n  version   = "latest"\n}\n\n# === FEATURES COMPLETAS PARA PRODU\xc7\xc3O ===\n# Todos os recursos de prote\xe7\xe3o habilitados\nenable_backup         = true      # Backup obrigat\xf3rio em produ\xe7\xe3o\nbackup_retention_days = 90        # Reten\xe7\xe3o longa para compliance\nenable_monitoring     = true      # Monitoring 24x7 obrigat\xf3rio\n\n# === AUTO-SHUTDOWN DESABILITADO ===\n# Produ\xe7\xe3o n\xe3o pode ser desligada automaticamente\nauto_shutdown_time     = "0000"   # Desabilitado (00:00 = sem shutdown)\nauto_shutdown_timezone = "E. South America Standard Time"\n\n# === TAGS DE PRODU\xc7\xc3O ===\n# Tags espec\xedficas para ambiente de produ\xe7\xe3o com informa\xe7\xf5es cr\xedticas\ntags = {\n  Owner        = "Operations Team"   # Time de opera\xe7\xf5es respons\xe1vel\n  CostCenter   = "Production"        # Centro de custo de produ\xe7\xe3o\n  Environment  = "Production"        # Identifica\xe7\xe3o cr\xedtica do ambiente\n  Criticality  = "High"             # Criticidade alta\n  BackupPolicy = "Daily"            # Pol\xedtica de backup di\xe1rio\n  Monitoring   = "24x7"             # Monitoramento cont\xednuo\n  Compliance   = "Required"         # Compliance obrigat\xf3rio\n  DataClass    = "Confidential"     # Classifica\xe7\xe3o dos dados\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"comandos-de-execu\xe7\xe3o",children:"Comandos de Execu\xe7\xe3o"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'# === CONFIGURA\xc7\xc3O INICIAL DO AZURE ===\n# Login no Azure e configura\xe7\xe3o da subscription\naz login\naz account list --output table\naz account set --subscription "sua-subscription-id"\naz account show\n\n# Exportar vari\xe1vel de ambiente para subscription (opcional)\nexport ARM_SUBSCRIPTION_ID="sua-subscription-id"\n\n# === INICIALIZA\xc7\xc3O DO TERRAFORM ===\n# Inicializa o projeto, baixa providers e configura backend\nterraform init\n\n# Valida sintaxe e configura\xe7\xe3o dos arquivos\nterraform validate\n\n# Formata c\xf3digo para manter padr\xe3o consistente\nterraform fmt\n\n# === DEPLOYMENT POR AMBIENTE ===\n# Desenvolvimento - recursos m\xednimos\nterraform plan -var-file="dev.tfvars"\nterraform apply -var-file="dev.tfvars" -auto-approve\n\n# Produ\xe7\xe3o - recursos completos (cuidado!)\nterraform plan -var-file="prod.tfvars"\nterraform apply -var-file="prod.tfvars"\n\n# === VERIFICA\xc7\xc3O DOS RECURSOS ===\n# Mostra todos os outputs definidos\nterraform output\n\n# Lista recursos criados no Azure\naz resource list --resource-group $(terraform output -raw resource_group_name) --output table\n\n# Lista espec\xedfica de VMs criadas\naz vm list --resource-group $(terraform output -raw resource_group_name) --output table\n\n# === TESTE DE CONECTIVIDADE SSH ===\n# Obt\xe9m IP p\xfablico da primeira VM\nVM_IP=$(az network public-ip show \\\n  --resource-group $(terraform output -raw resource_group_name) \\\n  --name webapp-dev-pip-1 \\\n  --query ipAddress -o tsv)\n\n# Salva chave SSH privada para conex\xe3o\nterraform output -raw ssh_private_key_pem > private_key.pem\nchmod 600 private_key.pem\n\n# Conecta \xe0 VM via SSH\nssh -i private_key.pem azureuser@$VM_IP\n\n# === TESTES DENTRO DA VM ===\n# Verifica informa\xe7\xf5es do sistema\nuname -a\ndf -h        # Espa\xe7o em disco\nlsblk        # Lista discos anexados\n\n# Instala e testa nginx\nsudo apt update\nsudo apt install -y nginx\nsudo systemctl start nginx\nsudo systemctl enable nginx\ncurl localhost   # Testa servidor web\n\n# === MONITORAMENTO DE CUSTOS ===\n# Verifica uso atual da subscription\naz consumption usage list --output table\n\n# Monitora custos no portal (abrir em navegador)\necho "Monitorar custos em: https://portal.azure.com/#blade/Microsoft_Azure_CostManagement/Menu/overview"\n\n# === LIMPEZA DOS RECURSOS ===\n# CUIDADO: Remove toda a infraestrutura criada\nterraform destroy -var-file="dev.tfvars" -auto-approve\n\n# Verifica se resource groups foram removidos\naz group list --output table\n'})}),"\n",(0,o.jsx)(e.h2,{id:"resumo-das-funcionalidades-demonstradas",children:"Resumo das Funcionalidades Demonstradas"}),"\n",(0,o.jsxs)(e.p,{children:["Este laborat\xf3rio final demonstra uso ",(0,o.jsx)(e.strong,{children:"avan\xe7ado"})," do Terraform com:"]}),"\n",(0,o.jsxs)(e.h3,{id:"-variables-e-valida\xe7\xe3o",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Variables e Valida\xe7\xe3o"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Variables tipadas (string, number, bool, object, list)"}),"\n",(0,o.jsx)(e.li,{children:"Valida\xe7\xe3o com regex, contains(), range checks"}),"\n",(0,o.jsx)(e.li,{children:"Objetos complexos para configura\xe7\xe3o de imagens"}),"\n",(0,o.jsx)(e.li,{children:"Valida\xe7\xe3o de CIDRs e emails"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-locals-e-l\xf3gica-complexa",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Locals e L\xf3gica Complexa"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Naming conventions centralizadas"}),"\n",(0,o.jsx)(e.li,{children:"Configura\xe7\xe3o condicional por ambiente"}),"\n",(0,o.jsx)(e.li,{children:"Maps de objetos para configura\xe7\xf5es"}),"\n",(0,o.jsx)(e.li,{children:"For expressions para listas din\xe2micas"}),"\n",(0,o.jsx)(e.li,{children:"Merge de tags padr\xe3o com personalizadas"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-outputs-informativos",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Outputs Informativos"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Informa\xe7\xf5es de recursos criados"}),"\n",(0,o.jsx)(e.li,{children:"Comandos SSH prontos para uso"}),"\n",(0,o.jsx)(e.li,{children:"Dados para estimativa de custos"}),"\n",(0,o.jsx)(e.li,{children:"Resumo completo do deployment"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-count-e-for-expressions",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Count e For Expressions"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"M\xfaltiplas VMs com count"}),"\n",(0,o.jsx)(e.li,{children:"Public IPs din\xe2micos"}),"\n",(0,o.jsx)(e.li,{children:"Regras de seguran\xe7a geradas dinamicamente"}),"\n",(0,o.jsx)(e.li,{children:"Resources attachments em loop"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-providers-m\xfaltiplos",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Providers M\xfaltiplos"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"azurerm"}),": Recursos do Azure"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"random"}),": IDs \xfanicos para storage"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"tls"}),": Gera\xe7\xe3o autom\xe1tica de chaves SSH"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"time"}),": Timestamps e delays"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"null"}),": Triggers e depend\xeancias"]}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-recursos-condicionais",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Recursos Condicionais"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Load Balancer s\xf3 com m\xfaltiplas VMs"}),"\n",(0,o.jsx)(e.li,{children:"Backup baseado em flags"}),"\n",(0,o.jsx)(e.li,{children:"Monitoring condicional"}),"\n",(0,o.jsx)(e.li,{children:"Auto-shutdown por ambiente"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-data-sources",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Data Sources"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Azure client config autom\xe1tico"}),"\n",(0,o.jsx)(e.li,{children:"Informa\xe7\xf5es da sess\xe3o atual"}),"\n",(0,o.jsx)(e.li,{children:"Tenant e subscription IDs"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-funcionalidades-de-produ\xe7\xe3o",children:["\u2705 ",(0,o.jsx)(e.strong,{children:"Funcionalidades de Produ\xe7\xe3o"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Key Vault para secrets"}),"\n",(0,o.jsx)(e.li,{children:"Network Security Groups"}),"\n",(0,o.jsx)(e.li,{children:"Managed Disks separados"}),"\n",(0,o.jsx)(e.li,{children:"Boot diagnostics"}),"\n",(0,o.jsx)(e.li,{children:"Auto-shutdown para economia"}),"\n",(0,o.jsx)(e.li,{children:"Tags organizacionais completas"}),"\n",(0,o.jsx)(e.li,{children:"Backup policies"}),"\n",(0,o.jsx)(e.li,{children:"Log Analytics e monitoring"}),"\n",(0,o.jsx)(e.li,{children:"Application Security Groups"}),"\n",(0,o.jsx)(e.li,{children:"Private DNS zones"}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"-estimativa-de-custos",children:["\ud83d\udcb0 ",(0,o.jsx)(e.strong,{children:"Estimativa de Custos"})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Desenvolvimento"}),": ~$8-15 USD/m\xeas (com auto-shutdown)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Produ\xe7\xe3o"}),": ~$390-515 USD/m\xeas (3 VMs, backup completo, monitoring)"]}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["Este \xe9 um ",(0,o.jsx)(e.strong,{children:"projeto de portf\xf3lio"})," que demonstra dom\xednio profissional do Terraform para Infrastructure as Code em ambiente empresarial."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{})})]})}function l(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(u,{...n})}):u(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>s,x:()=>t});var r=a(6540);const o={},i=r.createContext(o);function s(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);