"use strict";(self.webpackChunkdevops_automation_site=self.webpackChunkdevops_automation_site||[]).push([[1418],{2689:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"modulo-04-avancado/github-token","title":"Github Token","description":"Introdu\xe7\xe3o","source":"@site/curso-github-actions-udemy/modulo-04-avancado/01-GitHub-Token.md","sourceDirName":"modulo-04-avancado","slug":"/modulo-04-avancado/github-token","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/github-token","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"github-token","title":"Github Token"},"sidebar":"tutorialSidebar","previous":{"title":"Jobs: Paralelo vs Sequencial","permalink":"/udemy/github-actions-automacao/modulo-03-Criando-workflow/jobs"},"next":{"title":"Secrets & Vari\xe1veis no GitHub Actions","permalink":"/udemy/github-actions-automacao/modulo-04-avancado/secrets"}}');var a=s(4848),i=s(8453);const t={id:"github-token",title:"Github Token"},r="Permiss\xf5es e GITHUB_TOKEN: Menor Privil\xe9gio",c={},d=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Defini\xe7\xe3o",id:"defini\xe7\xe3o",level:2},{value:"Explica\xe7\xe3o T\xe9cnica",id:"explica\xe7\xe3o-t\xe9cnica",level:2},{value:"Exemplo",id:"exemplo",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function l(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.header,{children:(0,a.jsx)(o.h1,{id:"permiss\xf5es-e-github_token-menor-privil\xe9gio",children:"Permiss\xf5es e GITHUB_TOKEN: Menor Privil\xe9gio"})}),"\n",(0,a.jsx)(o.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,a.jsx)(o.p,{children:"O GITHUB_TOKEN \xe9 criado automaticamente em cada execu\xe7\xe3o do GitHub Actions e herda um conjunto de permiss\xf5es. Definir essas permiss\xf5es com o princ\xedpio do menor privil\xe9gio reduz riscos, evita escritas indevidas em PRs e atende a requisitos de seguran\xe7a de organiza\xe7\xf5es."}),"\n",(0,a.jsx)(o.h2,{id:"defini\xe7\xe3o",children:"Defini\xe7\xe3o"}),"\n",(0,a.jsx)(o.p,{children:"O GITHUB_TOKEN \xe9 uma credencial ef\xeamera que o GitHub injeta automaticamente durante a execu\xe7\xe3o do workflow. Ele autentica chamadas \xe0 API do GitHub sem que voc\xea precise expor um token pessoal (PAT)."}),"\n",(0,a.jsx)(o.p,{children:"O bloco permissions no YAML limita o que o GITHUB_TOKEN pode ler ou gravar. Ele pode ser declarado no topo do workflow para definir um padr\xe3o para todos os trabalhos e tamb\xe9m sobrescrito em um trabalho espec\xedfico quando voc\xea precisar elevar ou reduzir o escopo apenas naquele trecho."}),"\n",(0,a.jsx)(o.p,{children:"Refer\xeancias oficiais:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["permissions (workflow syntax): ",(0,a.jsx)(o.a,{href:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#permissions",children:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#permissions"})]}),"\n",(0,a.jsxs)(o.li,{children:["Autentica\xe7\xe3o autom\xe1tica (GITHUB_TOKEN): ",(0,a.jsx)(o.a,{href:"https://docs.github.com/pt/actions/security-guides/automatic-token-authentication",children:"https://docs.github.com/pt/actions/security-guides/automatic-token-authentication"})]}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"explica\xe7\xe3o-t\xe9cnica",children:"Explica\xe7\xe3o T\xe9cnica"}),"\n",(0,a.jsxs)(o.p,{children:["Voc\xea pode definir permissions no topo do workflow para estabelecer um padr\xe3o de acesso m\xednimo e, quando necess\xe1rio, sobrescrever no n\xedvel do trabalho para afinar o escopo. Um padr\xe3o comum \xe9 come\xe7ar com ",(0,a.jsx)(o.code,{children:"contents: read"})," e elevar apenas o que for preciso por trabalho. Esse desenho ajuda a isolar tarefas que precisam escrever (por exemplo, comentar em um PR) daquelas que apenas constroem ou testam."]}),"\n",(0,a.jsxs)(o.p,{children:["As permiss\xf5es mais usadas incluem ",(0,a.jsx)(o.code,{children:"contents"})," (acesso ao reposit\xf3rio para leitura e, se configurado, escrita como cria\xe7\xe3o de tags e releases), ",(0,a.jsx)(o.code,{children:"pull-requests"})," (habilita comentar ou atualizar PRs), ",(0,a.jsx)(o.code,{children:"checks"})," e ",(0,a.jsx)(o.code,{children:"statuses"})," (publicam resultados e status de checagens), ",(0,a.jsx)(o.code,{children:"deployments"})," (cria\xe7\xe3o e atualiza\xe7\xe3o de deployments), ",(0,a.jsx)(o.code,{children:"pages"})," (publica\xe7\xe3o no GitHub Pages) e ",(0,a.jsx)(o.code,{children:"id-token"})," (emiss\xe3o de token OIDC para autentica\xe7\xe3o federada). Ative apenas o que o trabalho realmente precisa."]}),"\n",(0,a.jsxs)(o.p,{children:["O comportamento varia conforme o evento. Em PRs vindos de forks, o GITHUB_TOKEN tem permiss\xf5es restritas e segredos n\xe3o s\xe3o disponibilizados, reduzindo risco de escrita indevida. O evento ",(0,a.jsx)(o.code,{children:"pull_request_target"})," roda no contexto do reposit\xf3rio base e pode acessar segredos e permiss\xf5es elevadas, portanto requer cautela, revis\xf5es e controles adicionais. PRs do Dependabot usam um contexto pr\xf3prio, com gest\xe3o separada de segredos; evite depender de segredos do reposit\xf3rio nesses casos. Para publicar no GitHub Pages, os fluxos oficiais exigem ",(0,a.jsx)(o.code,{children:"pages: write"})," e, em geral, ",(0,a.jsx)(o.code,{children:"id-token: write"})," para uso de a\xe7\xf5es como ",(0,a.jsx)(o.code,{children:"actions/deploy-pages"}),"."]}),"\n",(0,a.jsx)(o.p,{children:"Como regra de menor privil\xe9gio, comece com leitura m\xednima, separe trabalhos que precisam escrever dos que s\xf3 leem, evite qualquer escrita em PRs de forks e concentre permiss\xf5es elevadas somente no trabalho de deploy quando for publicar no Pages."}),"\n",(0,a.jsx)(o.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,a.jsx)(o.p,{children:"Exemplo 1 \u2014 Workflow com padr\xe3o m\xednimo e job que comenta em PR (apenas quando o evento for pull_request do mesmo reposit\xf3rio):"}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-yaml",children:'name: Aula 18 \u2014 Permiss\xf5es e GITHUB_TOKEN\non:\n  pull_request:\n    types: [opened, synchronize, reopened]\n\npermissions:\n  contents: read\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - name: Testes de build (sem escrita)\n        run: |\n          echo "Executando testes..."\n\n  comment:\n    # S\xf3 comenta quando n\xe3o \xe9 fork (evita escritas vindas de forks)\n    if: ${{ github.event.pull_request.head.repo.fork == false }}\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      pull-requests: write\n    steps:\n      - name: Comentar no PR\n        run: |\n          echo "Comentando no PR via API"\n          # Exemplo ilustrativo; uma action pr\xf3pria faria a chamada\n'})}),"\n",(0,a.jsx)(o.p,{children:"Exemplo 2 \u2014 Trabalho de deploy para GitHub Pages com permiss\xf5es espec\xedficas:"}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-yaml",children:'name: Deploy de Pages (exemplo)\non:\n  workflow_dispatch:\n\npermissions:\n  contents: read\n\njobs:\n  deploy-pages:\n    runs-on: ubuntu-latest\n    permissions:\n      pages: write\n      id-token: write\n    environment: github-pages\n    steps:\n      - name: Preparar artefatos de site\n        run: |\n          echo "Gerando site est\xe1tico..."\n      - name: Upload para Pages (exemplo conceitual)\n        run: |\n          echo "Enviando artefato para Pages..."\n          # Em fluxos reais, utilize actions/upload-pages-artifact e actions/deploy-pages\n'})}),"\n",(0,a.jsxs)(o.p,{children:["Esses exemplos mostram um padr\xe3o m\xednimo global com eleva\xe7\xe3o pontual por job, a preven\xe7\xe3o de escrita em PRs de forks e o uso de permiss\xf5es espec\xedficas para publicar no Pages (",(0,a.jsx)(o.code,{children:"pages: write"})," e ",(0,a.jsx)(o.code,{children:"id-token: write"}),") apenas no job de deploy."]}),"\n",(0,a.jsx)(o.p,{children:"Links \xfateis (oficiais):"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["permissions no YAML: ",(0,a.jsx)(o.a,{href:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#permissions",children:"https://docs.github.com/pt/actions/using-workflows/workflow-syntax-for-github-actions#permissions"})]}),"\n",(0,a.jsxs)(o.li,{children:["GITHUB_TOKEN e escopos: ",(0,a.jsx)(o.a,{href:"https://docs.github.com/pt/actions/security-guides/automatic-token-authentication",children:"https://docs.github.com/pt/actions/security-guides/automatic-token-authentication"})]}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,a.jsxs)(o.p,{children:["Definir ",(0,a.jsx)(o.code,{children:"permissions"})," de forma expl\xedcita e m\xednima no workflow e ajustar por job melhora a seguran\xe7a e a previsibilidade do pipeline. Trate PRs de forks como n\xe3o confi\xe1veis (sem escrita), eleve permiss\xf5es apenas quando necess\xe1rio e, para casos como Pages ou OIDC, habilite escopos pontuais (",(0,a.jsx)(o.code,{children:"pages: write"}),", ",(0,a.jsx)(o.code,{children:"id-token: write"}),"). Isso reduz superf\xedcie de ataque e facilita auditoria."]})]})}function u(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,a.jsx)(o,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,o,s)=>{s.d(o,{R:()=>t,x:()=>r});var n=s(6540);const a={},i=n.createContext(a);function t(e){const o=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),n.createElement(i.Provider,{value:o},e.children)}}}]);